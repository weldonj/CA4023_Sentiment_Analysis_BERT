
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overview of all the BERT models vs the Assignment 2 models &#8212; CA4023 Assignment 3 - BERT Sentiment Analysis - John Weldon</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Conclusion" href="CONCLUSION.html" />
    <link rel="prev" title="BERT with Negation Handling" href="256_BERT_NEGATION.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/bert.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4023 Assignment 3 - BERT Sentiment Analysis - John Weldon</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   OVERVIEW
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Baseline BERT
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT.html">
   BERT as given in assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT with 512 sequence length
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT.html">
   BERT with 512 Max Sequence Length
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT with 512 sequence length and 12 Epochs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT_12.html">
   BERT with 512 Max Sequence Length and 12 Epochs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT_12.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Baseline BERT with Negation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT_NEGATION.html">
   BERT with Negation Handling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT_NEGATION.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT vs Assignment 2 Performance
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Overview of all the BERT models vs the Assignment 2 models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#what-do-all-three-models-struggle-with">
   What do all three models struggle with?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#common-errors-to-all-three-models">
   Common Errors to all Three Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#what-bert-gets-right-that-the-other-2-do-not">
   What BERT gets right that the other 2 do not
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="#what-the-more-primitive-2-models-get-right-that-bert-does-not">
   What the More Primitive 2 Models get Right that BERT does not
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Conclusion and Learning Outcomes
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="CONCLUSION.html">
   Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CONCLUSION.html#learning-outcome">
   Learning Outcome
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/BERT_Ass2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/BERT_Ass2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Overview of all the BERT models vs the Assignment 2 models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-do-all-three-models-struggle-with">
   What do all three models struggle with?
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#common-errors-to-all-three-models">
   Common Errors to all Three Models
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-bert-gets-right-that-the-other-2-do-not">
   What BERT gets right that the other 2 do not
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#what-the-more-primitive-2-models-get-right-that-bert-does-not">
   What the More Primitive 2 Models get Right that BERT does not
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="overview-of-all-the-bert-models-vs-the-assignment-2-models">
<h1>Overview of all the BERT models vs the Assignment 2 models<a class="headerlink" href="#overview-of-all-the-bert-models-vs-the-assignment-2-models" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can take a look at how all of these models line up side by side in terms of average accuracy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Baseline NB&#39;</span><span class="p">,</span> <span class="s1">&#39;Baseline LR&#39;</span><span class="p">,</span> <span class="s1">&#39;BERT 256&#39;</span><span class="p">,</span> <span class="s1">&#39;BERT 512&#39;</span><span class="p">,</span> <span class="s1">&#39;BERT 512 12&#39;</span><span class="p">]</span>
<span class="n">y_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">objects</span><span class="p">))</span>
<span class="n">performance</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.829</span><span class="p">,</span><span class="mf">0.866</span><span class="p">,</span><span class="mf">0.89306</span><span class="p">,</span><span class="mf">0.9115</span><span class="p">,</span><span class="mf">0.9205</span><span class="p">]</span>
<span class="n">objects</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="n">objects</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="n">performance</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">_</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="n">objects</span><span class="p">),</span><span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">performance</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">y_pos</span><span class="p">,</span> <span class="n">objects</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Average Accuracy&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;All Models Compared&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mf">0.8</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/BERT_Ass2_3_0.png" src="_images/BERT_Ass2_3_0.png" />
</div>
</div>
<p>It’s clear to see now that the BERT model that utilizes a max sequence length of 512 and runs for 12 Epochs is the best model across both assignments as we might have expected. It takes significantly longer than the other configurations of BERT for a somewhat magrinal improvement so it would be useful to weigh up the time you have vs. the quality you ultimately want before making a decision on which to implement.</p>
<p>The next step is to take a look at which reviews fool all of the models and then see what BERT can do better than the 2 more primitive models and vice versa</p>
</div>
<div class="section" id="what-do-all-three-models-struggle-with">
<h1>What do all three models struggle with?<a class="headerlink" href="#what-do-all-three-models-struggle-with" title="Permalink to this headline">¶</a></h1>
<p>This first cell can largely be ignored as it is simply using code from the previous notebooks to build our list of errors that BERT has in the first CV fold</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bert_512_12_files</span> <span class="o">=</span> <span class="p">[]</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">bert_512_12_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;512_12_BERT/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_pred_512_12.txt&#39;</span><span class="p">)</span>
    
<span class="n">c_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;pred&#39;</span><span class="p">,</span><span class="s1">&#39;correct&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>

<span class="n">df1_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df2_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df3_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df4_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df5_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df6_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df7_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df8_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df9_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df10_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>

<span class="n">dataframes_512_12</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1_512_12</span><span class="p">,</span><span class="n">df2_512_12</span><span class="p">,</span><span class="n">df3_512_12</span><span class="p">,</span><span class="n">df4_512_12</span><span class="p">,</span><span class="n">df5_512_12</span><span class="p">,</span><span class="n">df6_512_12</span><span class="p">,</span><span class="n">df7_512_12</span><span class="p">,</span><span class="n">df8_512_12</span><span class="p">,</span><span class="n">df9_512_12</span><span class="p">,</span><span class="n">df10_512_12</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">create_dfs</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">df_list</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>

        <span class="c1">#dataframe = pd.DataFrame(columns=[&#39;index&#39;,&#39;gold&#39;,&#39;pred&#39;,&#39;correct&#39;,&#39;text&#39;])</span>
        <span class="n">processed_lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">line_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
                <span class="n">temp_line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">line_length</span><span class="p">)):</span>
                    <span class="n">temp_line</span> <span class="o">=</span> <span class="n">temp_line</span> <span class="o">+</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>

                <span class="n">processed_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tokens</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">temp_line</span><span class="p">]</span>
                <span class="n">processed_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_line</span><span class="p">)</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_line</span>
                <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>

<span class="n">dataframes_512_12</span> <span class="o">=</span> <span class="n">create_dfs</span><span class="p">(</span><span class="n">bert_512_12_files</span><span class="p">,</span> <span class="n">dataframes_512_12</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_f1</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
    <span class="n">true_pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">true_neg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">false_pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">false_neg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">corrects</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">corrects</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
            <span class="n">true_pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="n">false_neg</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="n">true_neg</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
            <span class="n">false_pos</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">corrects</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_pos</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_neg</span><span class="p">)</span>
    <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span><span class="n">precision</span><span class="p">,</span><span class="n">recall</span><span class="p">,</span><span class="n">f1_score</span><span class="p">,</span><span class="n">errors</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_averages</span><span class="p">(</span><span class="n">df_list</span><span class="p">):</span>
    <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">precs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f1s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">errors_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>    
        <span class="n">true_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_neg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">false_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">false_neg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">corrects</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                <span class="n">corrects</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
                <span class="n">true_pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
                <span class="n">false_neg</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
                <span class="n">true_neg</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
                <span class="n">false_pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">corrects</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
        <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
        
        <span class="n">precision</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_pos</span><span class="p">)</span>
        <span class="n">precs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

        <span class="n">recall</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_neg</span><span class="p">)</span>
        <span class="n">recs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
        
        <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">))</span>
        <span class="n">f1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">)</span>
        
        <span class="n">errors_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        
    <span class="k">return</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">precs</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">f1s</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span> <span class="n">errors_list</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">print_averages_get_errors</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">errorlist</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">acc</span><span class="p">,</span><span class="n">prec</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">errors</span> <span class="o">=</span> <span class="n">get_averages</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errorlist</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataframes</span><span class="p">):</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">get_f1</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross validation </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The accuracy is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The precision is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The recall is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The F1 score is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The model got the following rows wrong </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average precision is </span><span class="si">{</span><span class="n">prec</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average recall is </span><span class="si">{</span><span class="n">rec</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average F1 score is </span><span class="si">{</span><span class="n">f1</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_512_12</span> <span class="o">=</span> <span class="n">print_averages_get_errors</span><span class="p">(</span><span class="n">dataframes_512_12</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can take a look at which reviews BERT has classified incorrectly</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 10, 24, 25, 44, 50, 82, 91, 118, 135, 157, 171]
</pre></div>
</div>
</div>
</div>
<p>This next cell can largely be ignored as it just adapted using code from assignment 2 which allowed be to store which reviews the Naive Bayes and Logistic Regression models classified inaccurately</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">class</span> <span class="nc">PL04DataLoader_Part_1</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">get_labelled_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Compile a fold of the data set</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_documents</span><span class="p">(</span>
                <span class="n">fold</span> <span class="o">=</span> <span class="n">fold</span><span class="p">,</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">document</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dataset</span>
    
    <span class="k">def</span> <span class="nf">get_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Enumerate the raw contents of all data set files.</span>
<span class="sd">            Args:</span>
<span class="sd">                data_dir: relative or absolute path to the data set folder</span>
<span class="sd">                fold: which fold to load (0 to n_folds-1)</span>
<span class="sd">                label: &#39;pos&#39; or &#39;neg&#39; to</span>
<span class="sd">                    select data with positive or negative sentiment</span>
<span class="sd">                    polarity</span>
<span class="sd">            Return:</span>
<span class="sd">                List of tokenised documents, each a list of sentences</span>
<span class="sd">                that in turn are lists of tokens</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="k">class</span> <span class="nc">PL04DataLoader</span><span class="p">(</span><span class="n">PL04DataLoader_Part_1</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">get_xval_splits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Split data with labels for cross-validation</span>
<span class="sd">            returns a list of k pairs (training_data, test_data)</span>
<span class="sd">            for k cross-validation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># load the folds</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_labelled_dataset</span><span class="p">(</span>
                <span class="n">fold</span> <span class="o">=</span> <span class="n">i</span>
            <span class="p">))</span>
        <span class="c1"># create training-test splits</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">training_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
                <span class="n">ij1</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
                <span class="k">assert</span> <span class="n">ij1</span> <span class="o">!=</span> <span class="n">i</span>
                <span class="n">training_data</span> <span class="o">=</span> <span class="n">training_data</span> <span class="o">+</span> <span class="n">folds</span><span class="p">[</span><span class="n">ij1</span><span class="p">]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">training_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">retval</span>
    
<span class="k">class</span> <span class="nc">PL04DataLoaderFromStream</span><span class="p">(</span><span class="n">PL04DataLoader</span><span class="p">):</span>
        
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tgz_stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r|gz&#39;</span><span class="p">,</span>
            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">tgz_stream</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">tar_archive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tar_member</span> <span class="ow">in</span> <span class="n">tar_archive</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">2000</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">path_components</span> <span class="o">=</span> <span class="n">tar_member</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">path_components</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;cv&#39;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">path_components</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">fold</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filename</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">fold</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">tar_archive</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="n">tar_member</span><span class="p">)</span>
                    <span class="n">document</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                    <span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            
    <span class="k">def</span> <span class="nf">get_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[(</span><span class="n">fold</span><span class="p">,</span> <span class="n">label</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">PL04DataLoaderFromTGZ</span><span class="p">(</span><span class="n">PL04DataLoaderFromStream</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tgz_stream</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tgz_stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
<span class="n">dir_entries</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
<span class="n">dir_entries</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="n">data_loader</span> <span class="o">=</span> <span class="n">PL04DataLoaderFromTGZ</span><span class="p">(</span><span class="s1">&#39;data.tar.gz&#39;</span><span class="p">)</span>
<span class="c1"># test &quot;get_xval_splits()&quot;</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">data_loader</span><span class="o">.</span><span class="n">get_xval_splits</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">PolarityPredictorInterface</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_with_labels</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="k">class</span> <span class="nc">PolarityPredictorWithVocabulary</span><span class="p">(</span><span class="n">PolarityPredictorInterface</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_with_labels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_vocab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_vocab_from_data</span><span class="p">(</span><span class="n">data_with_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finalise_vocab</span><span class="p">()</span>
        <span class="n">tr_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span>
            <span class="n">data_with_labels</span>
        <span class="p">)</span>
        <span class="n">tr_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data_with_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_model_on_features</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">reset_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">add_to_vocab_from_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">document</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">document</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finalise_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
        <span class="c1"># create reverse map for fast token lookup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
        
    <span class="k">def</span> <span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
    
    <span class="k">def</span> <span class="nf">get_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">label2index</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
<span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">class</span> <span class="nc">PolarityPredictorWithBagOfWords_01</span><span class="p">(</span><span class="n">PolarityPredictorWithVocabulary</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clip_counts</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_counts</span> <span class="o">=</span> <span class="n">clip_counts</span>
        
    <span class="k">def</span> <span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># create numpy array of required size</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>        
        <span class="c1"># populate feature matrix</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">document</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">document</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="c1"># token not in vocab</span>
                        <span class="c1"># --&gt; skip this token</span>
                        <span class="c1"># --&gt; continue with next token</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_counts</span><span class="p">:</span>
                        <span class="n">features</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">features</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">features</span>
    
<span class="k">class</span> <span class="nc">PolarityPredictorWithBagOfWords</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords_01</span><span class="p">):</span>
 
    <span class="k">def</span> <span class="nf">get_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; create column vector with target labels</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># prepare target vector</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span>
                <span class="n">targets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">targets</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="k">class</span> <span class="nc">PolarityPredictorBowNB</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="c1"># pass numpy array to sklearn to train NB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">get_confusion_matrix</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># use numpy to get predictions</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="c1"># restore labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">is_positive</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">is_positive</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_accuracy</span> <span class="ow">or</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">get_accuracy</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">PolarityPredictorBowNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">predictions</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">corrects</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">==</span><span class="n">pred</span>

<span class="n">incorrects_nb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">answer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corrects</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">incorrects_nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And now we can see the list of review number in CV fold 1 that the NB model has classified incorrectly. It’s immediately clear that it is longer than the list for BERT which is to be expected</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incorrects_nb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 4,
 19,
 22,
 25,
 28,
 34,
 40,
 44,
 49,
 50,
 54,
 55,
 57,
 58,
 72,
 75,
 80,
 82,
 89,
 90,
 93,
 98,
 103,
 108,
 110,
 124,
 125,
 134,
 135,
 141,
 142,
 154,
 159,
 160,
 175,
 176,
 186,
 190,
 194,
 197]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="k">class</span> <span class="nc">PolarityPredictorBowLR</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="c1"># pass numpy array to sklearn to train Logistic Regression</span>
        <span class="c1"># iterations set to 1000 as default of 100 didn&#39;t guarantee convergence with our data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">get_confusion_matrix</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># use numpy to get predictions</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="c1"># restore labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">is_positive</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">is_positive</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_accuracy</span> <span class="ow">or</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">get_accuracy</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">PolarityPredictorBowLR</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="n">predictions</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">corrects</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">==</span><span class="n">pred</span>

<span class="n">incorrects_lr</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">answer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corrects</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">incorrects_lr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>And now we can see the list of review number in CV fold 1 that the LR model has classified incorrectly. It’s immediately clear that it is also longer than the list for BERT which again is to be expected</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incorrects_lr</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 4,
 22,
 24,
 26,
 28,
 34,
 40,
 50,
 54,
 56,
 57,
 72,
 82,
 98,
 100,
 110,
 111,
 118,
 125,
 132,
 154,
 160,
 161,
 175,
 176,
 181,
 183,
 188,
 190,
 194]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 4, 10, 24, 25, 44, 50, 82, 91, 118, 135, 157, 171]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="common-errors-to-all-three-models">
<h1>Common Errors to all Three Models<a class="headerlink" href="#common-errors-to-all-three-models" title="Permalink to this headline">¶</a></h1>
<p>These next two cells allow us to compare the three lists of reviews that each of the three models has gotten wrong and find reviews that are common to all three. Then we can examine these reviews and determine what kinds of reviews can mislead all three model types and what they are all likely to struggle with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_BERT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">incorrects_nb</span><span class="p">:</span>
        <span class="n">common_to_NB_BERT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_BERT_LR</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_to_NB_BERT</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">common_to_NB_BERT</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">incorrects_lr</span><span class="p">:</span>
        <span class="n">common_to_NB_BERT_LR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common_to_NB_BERT</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_BERT_LR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[4, 50, 82]
</pre></div>
</div>
</div>
</div>
<p>Now that we have identified the five reviews that all three models have predicted incorrectly, we can take the time to try examine why this might be</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       bronx &quot; , was supposedly set in new york , but...
Name: 4, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">4</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;moviemaking is a lot like being the general manager of an nfl team in the post-salary cap era -- you\&#39;ve got to know how to allocate your resources .every dollar spent on a free-agent defensive tackle is one less dollar than you can spend on linebackers or safeties or centers .in the nfl , this leads to teams like the detroit lions , who boast a superstar running back with a huge contract , but can only field five guys named herb to block for him .in the movies , you end up with films like &quot; spawn &quot; , with a huge special-effects budget but not enough money to hire any recognizable actors .jackie chan is the barry sanders of moviemaking .he spins and darts across the screen like sanders cutting back through the defensive line .watching jackie in operation condor as he drives his motorcycle through the crowded streets of madrid , fleeing an armada of pursuers in identical black compact cars , is reminiscent of sanders running for daylight with the chicago bears in hot pursuit , except that sanders doesn\&#39;t have to worry about rescuing runaway baby carriages .but like the lions star , jackie doesn\&#39;t have anybody to block for him .almost every cent that\&#39;s invested in a jackie chan movie goes for stunts , and as chan does his own stunts , the rest of the money goes to pay his hospital bills .this leaves about 75 cents to pay for things like directors ( chan directs ) , scripts and dubbing and supporting characters , not to mention the hideous title sequence .this also explains why the movie was shot in odd places like morocco and spain .( chan\&#39;s first release in this country , &quot; rumble in the bronx &quot; , was supposedly set in new york , but was filmed in vancouver , and in the chase scenes the canadian rockies are clearly visible . )heck , jackie doesn\&#39;t even have enough money for a haircut , looks like , much less a personal hairstylist .in condor , chan plays the same character he\&#39;s always played , himself , a mixture of bruce lee and tim allen , a master of both kung-fu and slapstick-fu .jackie is sent by the un to retrieve a cache of lost nazi gold in the north african desert , and is chased by a horde of neo-nazi sympathizers and two stereotypical arabs ( one of the things i like about jackie chan movies : no political correctness ) .he is joined by three women , who have little to do except scream , &quot; jackie , save us ! &quot; , and misuse firearms .the villain is an old nazi whose legs were broken in the secret base so that he has to be carried everywhere , and he\&#39;s more pathetic than evil .en route , we have an extended motorcycle chase scene , a hilarious fight in the moroccan version of motel 6 with the neo-nazis , and two confrontations with savage natives .once at the secret desert base , there is a long chop-socky sequence , followed by the film\&#39;s centerpiece , a wind-tunnel fight that\&#39;s even better than the one in face/off .this is where the money was spent , on well-choreographed kung-fu sequences , on giant kevlar hamster balls , on smashed-up crates of bananas , and on scorpions .ignore the gaping holes in the plot ( how , exactly , if the villain\&#39;s legs were broken , did he escape from the secret nazi base , and why didn\&#39;t he take the key with him ? ) .don\&#39;t worry about the production values , or what , exactly , the japanese girl was doing hitchhiking across the sahara .just go see the movie .operation condor has pretentions of being a &quot; raiders of the lost ark &quot; knockoff , but one wonders what jackie could do with the raiders franchise blocking for him -- with a lawrence kazdan screenplay , a john williams score , spielberg directing and george lucas producing , condor might be an a+ movie .however , you\&#39;ve got to go with what you\&#39;ve got , and what you\&#39;ve got in jackie chan is something special -- a talent that mainstream hollywood should , could , and ought to utilize .&#39;
</pre></div>
</div>
</div>
</div>
<p><em>moviemaking is a lot like being the general manager of an nfl team in the post-salary cap era – you’ve got to know how to allocate your resources .every dollar spent on a free-agent defensive tackle is one less dollar than you can spend on linebackers or safeties or centers .in the nfl , this leads to teams like the detroit lions , who boast a superstar running back with a huge contract , but can only field five guys named herb to block for him .in the movies , you end up with films like ” spawn ” , with a huge special-effects budget but not enough money to hire any recognizable actors .jackie chan is the barry sanders of moviemaking .he spins and darts across the screen like sanders cutting back through the defensive line .watching jackie in operation condor as he drives his motorcycle through the crowded streets of madrid , fleeing an armada of pursuers in identical black compact cars , is reminiscent of sanders running for daylight with the chicago bears in hot pursuit , except that sanders doesn’t have to worry about rescuing runaway baby carriages .but like the lions star , jackie doesn’t have anybody to block for him .almost every cent that’s invested in a jackie chan movie goes for stunts , and as chan does his own stunts , the rest of the money goes to pay his hospital bills .this leaves about 75 cents to pay for things like directors ( chan directs ) , scripts and dubbing and supporting characters , not to mention the hideous title sequence .this also explains why the movie was shot in odd places like morocco and spain .( chan’s first release in this country , ” rumble in the bronx ” , was supposedly set in new york , but was filmed in vancouver , and in the chase scenes the canadian rockies are clearly visible . )heck , jackie doesn’t even have enough money for a haircut , looks like , much less a personal hairstylist .in condor , chan plays the same character he’s always played , himself , a mixture of bruce lee and tim allen , a master of both kung-fu and slapstick-fu .jackie is sent by the un to retrieve a cache of lost nazi gold in the north african desert , and is chased by a horde of neo-nazi sympathizers and two stereotypical arabs ( one of the things i like about jackie chan movies : no political correctness ) .he is joined by three women , who have little to do except scream , ” jackie , save us ! ” , and misuse firearms .the villain is an old nazi whose legs were broken in the secret base so that he has to be carried everywhere , and he’s more pathetic than evil .en route , we have an extended motorcycle chase scene , a hilarious fight in the moroccan version of motel 6 with the neo-nazis , and two confrontations with savage natives .once at the secret desert base , there is a long chop-socky sequence , followed by the film’s centerpiece , a wind-tunnel fight that’s even better than the one in face/off .this is where the money was spent , on well-choreographed kung-fu sequences , on giant kevlar hamster balls , on smashed-up crates of bananas , and on scorpions .ignore the gaping holes in the plot ( how , exactly , if the villain’s legs were broken , did he escape from the secret nazi base , and why didn’t he take the key with him ? ) .don’t worry about the production values , or what , exactly , the japanese girl was doing hitchhiking across the sahara .just go see the movie .operation condor has pretentions of being a ” raiders of the lost ark ” knockoff , but one wonders what jackie could do with the raiders franchise blocking for him – with a lawrence kazdan screenplay , a john williams score , spielberg directing and george lucas producing , condor might be an a+ movie .however , you’ve got to go with what you’ve got , and what you’ve got in jackie chan is something special – a talent that mainstream hollywood should , could , and ought to utilize .</em></p>
<p>In this case, all three models have predicted that the review is negative when it’s actually labelled as positive. One thing that may be in play here is the word “nazi”. It turns up many times and one would assume it has negative connotations. There are also a lack of clear compliments about the movie, but various other words one would associate with negativity (“hideous title sequence”, “knockoff”, “odd”). There are also some analogies, such as comparing Jackie CHan to an NFL player, that aren’t very straightforward. I would imagine this can confuse BERT.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       , trying to duplicate its success . ( pcu anyo...
Name: 50, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">50</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;national lampoon\&#39;s animal house , made in 1978 and set in 1962 , remains one of the -- no , fuck that noise -- * the * funniest movie ever made .and this isn\&#39;t just my opinion , either ; everybody knows this , and that\&#39;s why about a gazillion inferior rip-offs have been made , trying to duplicate its success .( pcu anyone ?and the first person to bring up glory daze gets decked . )animal house takes place at the fictional faber college , circa 1962 , where the omega frat calls the shots .these guys are wholesome , clean-cut , model-citizens . . .i . e .a bunch of assholes .greg , their leader , is going out with mandy pepperidge , but since the silly bastard doesn\&#39;t believe in pre-marital sex , their relationship never goes further than a quick jack-off under the stars .neidermeyer is the supreme-bozo of the bunch , walking around with his dick out kicking freshman ass and trying to impress the muff .also hanging around these losers is babs , future universal studios employee and serious bitch .now let\&#39;s just take a peak next door , at the delta house .over here , anything goes : you wanna throw shit out the window ?okay .you wanna crush a bunch of beer cans on your forehead and pour honey-mustard all over your chest ?go right ahead .the frat\&#39;s leaders are otter and boon ( tim matheson and peter riegert ) .otter is the ladies\&#39; man , going out with another girl every night , and boon is the comedian .he\&#39;s got a steady-date , katy ( karen allen ) , but she\&#39;s sick of playing second-fiddle to a bottle of j . d .then there are the others : pinto , a wimp ; flounder , a blimp ; d . day , a biker ; stork , who may or may not have brain-damage ; and last but not least . . .bluto !bluto , played by the late , great john belushi , is the man .he\&#39;s the kind of guy who slugs back entire fifths of whiskey then proclaim , &quot; i needed that . &quot;the kind of guy who puts a cream-filled snowball into his mouth , puffs up his cheeks and spits it out , and then says &quot; i\&#39;m a zit -- get it ? &quot;the story is as follows : the omegas are getting the deltas kicked off campus .the deltas , knowing that fighting the omegas is stupid , decide to go out with style , throwing a wild toga party and ruining the homecoming parade .this is the fucnniest movie int he history of the world .do yourself a favor and go see it .&#39;
</pre></div>
</div>
</div>
</div>
<p><em>national lampoon’s animal house , made in 1978 and set in 1962 , remains one of the – no , fuck that noise – * the * funniest movie ever made .and this isn’t just my opinion , either ; everybody knows this , and that’s why about a gazillion inferior rip-offs have been made , trying to duplicate its success .( pcu anyone ?and the first person to bring up glory daze gets decked . )animal house takes place at the fictional faber college , circa 1962 , where the omega frat calls the shots .these guys are wholesome , clean-cut , model-citizens …i . e .a bunch of assholes .greg , their leader , is going out with mandy pepperidge , but since the silly bastard doesn’t believe in pre-marital sex , their relationship never goes further than a quick jack-off under the stars .neidermeyer is the supreme-bozo of the bunch , walking around with his dick out kicking freshman ass and trying to impress the muff .also hanging around these losers is babs , future universal studios employee and serious bitch .now let’s just take a peak next door , at the delta house .over here , anything goes : you wanna throw shit out the window ?okay .you wanna crush a bunch of beer cans on your forehead and pour honey-mustard all over your chest ?go right ahead .the frat’s leaders are otter and boon ( tim matheson and peter riegert ) .otter is the ladies’ man , going out with another girl every night , and boon is the comedian .he’s got a steady-date , katy ( karen allen ) , but she’s sick of playing second-fiddle to a bottle of j . d .then there are the others : pinto , a wimp ; flounder , a blimp ; d . day , a biker ; stork , who may or may not have brain-damage ; and last but not least …bluto !bluto , played by the late , great john belushi , is the man .he’s the kind of guy who slugs back entire fifths of whiskey then proclaim , ” i needed that . “the kind of guy who puts a cream-filled snowball into his mouth , puffs up his cheeks and spits it out , and then says ” i’m a zit – get it ? “the story is as follows : the omegas are getting the deltas kicked off campus .the deltas , knowing that fighting the omegas is stupid , decide to go out with style , throwing a wild toga party and ruining the homecoming parade .this is the fucnniest movie int he history of the world .do yourself a favor and go see it .</em></p>
<p>For this review of National Lampoon’s Animal House it seems plausible that the large amount of explicit language may be tricking the models, leading them to decide that this is a negative review when it is in fact positive. It doesn’t use many words we would typically associate with positivity, and in fact, one of the few positive words is “funniest” is a typo that means it probably isn’t getting picked up (“fucnniest”).</p>
<p>It’s difficult to imagine a good way around this issue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       a big surprise to me . the good trailer had hi...
Name: 82, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">82</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;a big surprise to me .the good trailer had hinted that they pulled the impossible off , but making a blues brothers movie without jake blues ( john belushi ) is such a dumb idea i really had no hope .they replaced him just fine .not with john goodman , he didn\&#39;t do much of anything , but with the brilliant actor joe morton , who can really sing .the fourth blues brother is j evan bonifant , who\&#39;s ten .this was another of my fears for the film , but he\&#39;s a really good dancer , and plays a mean harmonica ( although he may have been dubbed ) .things that intellectually had bothered me before , like no mission from god , everyone being richer , it not being filmed in chicago -- gave me no problems at all .i\&#39;m quite pleased that there were less car pile-ups , because they meant less music , and john landis seems to have lost interest in the whole thing .there\&#39;s a few early crashes , and then one huge pile-up , but after that it all stops .it\&#39;s just the music .one of my problems with the first is that cab calloway\&#39;s song is so good the actually blues brothers look dull after him , but there\&#39;s no problems with this .the music is all as good as ever , tons of great musicians showing up -- with the exception of johnny lang , who can\&#39;t sing , all the musicians do a great job .the only real problems i had was the special effects .these were superfluous and a waste of money .since the film isn\&#39;t doing very well , they could mean we have no possibility of another sequel , which i want to see .the bluegrass version of riders in the sky is even better than rawhide .-- http : //www . geocities . com/hollywood/academy/8034/remove no spam to reply .&quot; drive carefully but recklessly &quot; , mama , child\&#39;s toy &quot; the only excercise i take is walking behind the coffins of friends who took exercise . &quot;peter o\&#39;toole&#39;
</pre></div>
</div>
</div>
</div>
<p><em>a big surprise to me .the good trailer had hinted that they pulled the impossible off , but making a blues brothers movie without jake blues ( john belushi ) is such a dumb idea i really had no hope .they replaced him just fine .not with john goodman , he didn’t do much of anything , but with the brilliant actor joe morton , who can really sing .the fourth blues brother is j evan bonifant , who’s ten .this was another of my fears for the film , but he’s a really good dancer , and plays a mean harmonica ( although he may have been dubbed ) .things that intellectually had bothered me before , like no mission from god , everyone being richer , it not being filmed in chicago – gave me no problems at all .i’m quite pleased that there were less car pile-ups , because they meant less music , and john landis seems to have lost interest in the whole thing .there’s a few early crashes , and then one huge pile-up , but after that it all stops .it’s just the music .one of my problems with the first is that cab calloway’s song is so good the actually blues brothers look dull after him , but there’s no problems with this .the music is all as good as ever , tons of great musicians showing up – with the exception of johnny lang , who can’t sing , all the musicians do a great job .the only real problems i had was the special effects .these were superfluous and a waste of money .since the film isn’t doing very well , they could mean we have no possibility of another sequel , which i want to see .the bluegrass version of riders in the sky is even better than rawhide .– http : //www . geocities . com/hollywood/academy/8034/remove no spam to reply .” drive carefully but recklessly ” , mama , child’s toy ” the only excercise i take is walking behind the coffins of friends who took exercise . “peter o’toole</em></p>
<p>Once again there are quite a few words here for that would typically be associated with a negative view of the movie. “dumb”, “waste”, “superfluous”, “problems”, “lost interest”, “dull”. There aren’t many terms that would be associated with a positive review to try to overcome this issue and this seems likely why all three models struggle here</p>
</div>
<div class="section" id="what-bert-gets-right-that-the-other-2-do-not">
<h1>What BERT gets right that the other 2 do not<a class="headerlink" href="#what-bert-gets-right-that-the-other-2-do-not" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_LR</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">incorrects_lr</span><span class="p">:</span>
        <span class="n">common_to_NB_LR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_LR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 4,
 22,
 28,
 34,
 40,
 50,
 54,
 57,
 72,
 82,
 98,
 110,
 125,
 154,
 160,
 175,
 176,
 190,
 194]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_NB_LR_not_BERT</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">common_to_NB_LR</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">common_to_NB_LR</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">in_NB_LR_not_BERT</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">common_to_NB_LR</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_NB_LR_not_BERT</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0, 22, 28, 34, 40, 54, 57, 72, 98, 110, 125, 154, 160, 175, 176, 190, 194]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     pos
correct                                                  yes
text       isn&#39;t so ) and proceeds to investigate the hor...
Name: 0, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;films adapted from comic books have had plenty of success , whether they\&#39;re about superheroes ( batman , superman , spawn ) , or geared toward kids ( casper ) or the arthouse crowd ( ghost world ) , but there\&#39;s never really been a comic book like from hell before .for starters , it was created by alan moore ( and eddie campbell ) , who brought the medium to a whole new level in the mid \&#39;80s with a 12-part series called the watchmen .to say moore and campbell thoroughly researched the subject of jack the ripper would be like saying michael jackson is starting to look a little odd .the book ( or &quot; graphic novel , &quot; if you will ) is over 500 pages long and includes nearly 30 more that consist of nothing but footnotes .in other words , don\&#39;t dismiss this film because of its source .if you can get past the whole comic book thing , you might find another stumbling block in from hell\&#39;s directors , albert and allen hughes .getting the hughes brothers to direct this seems almost as ludicrous as casting carrot top in , well , anything , but riddle me this : who better to direct a film that\&#39;s set in the ghetto and features really violent street crime than the mad geniuses behind menace ii society ?the ghetto in question is , of course , whitechapel in 1888 london\&#39;s east end .it\&#39;s a filthy , sooty place where the whores ( called &quot; unfortunates &quot; ) are starting to get a little nervous about this mysterious psychopath who has been carving through their profession with surgical precision .when the first stiff turns up , copper peter godley ( robbie coltrane , the world is not enough ) calls in inspector frederick abberline ( johnny depp , blow ) to crack the case .abberline , a widower , has prophetic dreams he unsuccessfully tries to quell with copious amounts of absinthe and opium .upon arriving in whitechapel , he befriends an unfortunate named mary kelly ( heather graham , say it isn\&#39;t so ) and proceeds to investigate the horribly gruesome crimes that even the police surgeon can\&#39;t stomach .i don\&#39;t think anyone needs to be briefed on jack the ripper , so i won\&#39;t go into the particulars here , other than to say moore and campbell have a unique and interesting theory about both the identity of the killer and the reasons he chooses to slay .in the comic , they don\&#39;t bother cloaking the identity of the ripper , but screenwriters terry hayes ( vertical limit ) and rafael yglesias ( les mis ? rables ) do a good job of keeping him hidden from viewers until the very end .it\&#39;s funny to watch the locals blindly point the finger of blame at jews and indians because , after all , an englishman could never be capable of committing such ghastly acts .and from hell\&#39;s ending had me whistling the stonecutters song from the simpsons for days ( &quot; who holds back the electric car/who made steve guttenberg a star ? &quot; ) .don\&#39;t worry - it\&#39;ll all make sense when you see it .now onto from hell\&#39;s appearance : it\&#39;s certainly dark and bleak enough , and it\&#39;s surprising to see how much more it looks like a tim burton film than planet of the apes did ( at times , it seems like sleepy hollow 2 ) .the print i saw wasn\&#39;t completely finished ( both color and music had not been finalized , so no comments about marilyn manson ) , but cinematographer peter deming ( don\&#39;t say a word ) ably captures the dreariness of victorian-era london and helped make the flashy killing scenes remind me of the crazy flashbacks in twin peaks , even though the violence in the film pales in comparison to that in the black-and-white comic .oscar winner martin childs\&#39; ( shakespeare in love ) production design turns the original prague surroundings into one creepy place .even the acting in from hell is solid , with the dreamy depp turning in a typically strong performance and deftly handling a british accent .ians holm ( joe gould\&#39;s secret ) and richardson ( 102 dalmatians ) log in great supporting roles , but the big surprise here is graham .i cringed the first time she opened her mouth , imagining her attempt at an irish accent , but it actually wasn\&#39;t half bad .the film , however , is all good .2 : 00 - r for strong violence/gore , sexuality , language and drug content&#39;
</pre></div>
</div>
</div>
</div>
<p><em>films adapted from comic books have had plenty of success , whether they’re about superheroes ( batman , superman , spawn ) , or geared toward kids ( casper ) or the arthouse crowd ( ghost world ) , but there’s never really been a comic book like from hell before .for starters , it was created by alan moore ( and eddie campbell ) , who brought the medium to a whole new level in the mid ’80s with a 12-part series called the watchmen .to say moore and campbell thoroughly researched the subject of jack the ripper would be like saying michael jackson is starting to look a little odd .the book ( or ” graphic novel , ” if you will ) is over 500 pages long and includes nearly 30 more that consist of nothing but footnotes .in other words , don’t dismiss this film because of its source .if you can get past the whole comic book thing , you might find another stumbling block in from hell’s directors , albert and allen hughes .getting the hughes brothers to direct this seems almost as ludicrous as casting carrot top in , well , anything , but riddle me this : who better to direct a film that’s set in the ghetto and features really violent street crime than the mad geniuses behind menace ii society ?the ghetto in question is , of course , whitechapel in 1888 london’s east end .it’s a filthy , sooty place where the whores ( called ” unfortunates ” ) are starting to get a little nervous about this mysterious psychopath who has been carving through their profession with surgical precision .when the first stiff turns up , copper peter godley ( robbie coltrane , the world is not enough ) calls in inspector frederick abberline ( johnny depp , blow ) to crack the case .abberline , a widower , has prophetic dreams he unsuccessfully tries to quell with copious amounts of absinthe and opium .upon arriving in whitechapel , he befriends an unfortunate named mary kelly ( heather graham , say it isn’t so ) and proceeds to investigate the horribly gruesome crimes that even the police surgeon can’t stomach .i don’t think anyone needs to be briefed on jack the ripper , so i won’t go into the particulars here , other than to say moore and campbell have a unique and interesting theory about both the identity of the killer and the reasons he chooses to slay .in the comic , they don’t bother cloaking the identity of the ripper , but screenwriters terry hayes ( vertical limit ) and rafael yglesias ( les mis ? rables ) do a good job of keeping him hidden from viewers until the very end .it’s funny to watch the locals blindly point the finger of blame at jews and indians because , after all , an englishman could never be capable of committing such ghastly acts .and from hell’s ending had me whistling the stonecutters song from the simpsons for days ( ” who holds back the electric car/who made steve guttenberg a star ? ” ) .don’t worry - it’ll all make sense when you see it .now onto from hell’s appearance : it’s certainly dark and bleak enough , and it’s surprising to see how much more it looks like a tim burton film than planet of the apes did ( at times , it seems like sleepy hollow 2 ) .the print i saw wasn’t completely finished ( both color and music had not been finalized , so no comments about marilyn manson ) , but cinematographer peter deming ( don’t say a word ) ably captures the dreariness of victorian-era london and helped make the flashy killing scenes remind me of the crazy flashbacks in twin peaks , even though the violence in the film pales in comparison to that in the black-and-white comic .oscar winner martin childs’ ( shakespeare in love ) production design turns the original prague surroundings into one creepy place .even the acting in from hell is solid , with the dreamy depp turning in a typically strong performance and deftly handling a british accent .ians holm ( joe gould’s secret ) and richardson ( 102 dalmatians ) log in great supporting roles , but the big surprise here is graham .i cringed the first time she opened her mouth , imagining her attempt at an irish accent , but it actually wasn’t half bad .the film , however , is all good .2 : 00 - r for strong violence/gore , sexuality , language and drug content</em></p>
<p>While there isn’t a whole lot of positive language in this review, there are sentences that human readers would be able to identify as positive. The Naive Bayes and LR models that use unigrams and bigrams have no way to capture this context but BERT does, having been trained on a gigantic corpus and also being bidirectional. I think in this review we are simply seeing a case where BERT shows its usefulness and the other two cannot keep up. Some of the more negative language is also hidden from BERT’s prying eyes here due to the 512 token limit. For example - “filthy , sooty place where the whores”</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">22</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     pos
correct                                                  yes
text       that we dug it . the first time i saw the cabl...
Name: 22, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">22</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;a fully loaded entertainment review - website coming in july !&gt;from ace ventura to truman burbank , jim carrey has run the whole gamut of comic , yet sympathetic , characters .1996\&#39;s the cable guy was supposed to be his big &quot; breakthrough &quot; role from zany humor into darker , more dramatic acting .as most everyone knows , the results were , well , less-than-stellar .not only did the film not do so hot at the box office , but it was also panned by critics .as far as i know , gene siskel and i are the only ones willing to admit that we dug it .the first time i saw the cable guy , in theatres , i was in super critic-mode , and didn\&#39;t really like it .however , due to the fact that hbo shows the movie every single day , i\&#39;ve had time to lean back , relax , and take in the film .and to my surprise , it grew on me .the plot is rather simple : broderick plays a guy named steven who befriends his cable guy , played by carrey , then is stalked by him when steven tries to break off the relationship .see , steven\&#39;s been having some problems with his girlfriend , robin ( leslie mann ) , and he doesn\&#39;t think he has any more room in his life for a new friend .also , some of the cable guy\&#39;s antics have been creeping him out .carrey , as the cable guy , gives steven various aliases , which later we find out are all tv characters : larry tate , chip douglas , ricky ricardo , etc . he apparently lives in his cable van , and while many critics didn\&#39;t enjoy this newer , darker , less-manic performance from carrey , i thought it was interesting and rather well-done .for me , its not the movie as a whole that\&#39;s enjoyable , but rather several individual scenes : a karaoke jam at steven\&#39;s apartment , a medieval fight at a theme restaurant , and a bathroom beating ( a la liar , liar ) , just to name a few .perhaps the fact that more of carrey\&#39;s humorous side comes out during these scenes is what makes them so funny .and if you really want to see something , you\&#39;ve got to hear his version of jefferson airplane\&#39;s &quot; somebody to love &quot; , sung at the aformentioned karaoke jam .the cable guy has its bad spots , like most any movie .i didn\&#39;t particularly like steven\&#39;s girlfriend , and i felt that more focus should have been used on the relationship between steven and his best friend .also , the ending , while having you fooled for a moment , is rather contrived , and somewhat dissapointing .still , i found the cable guy to be a worthwhile venture ; if you\&#39;re at the video store and can\&#39;t think of anything to rent , i suggest you try it out .or if you have hbo , just wait till it comes on ( you won\&#39;t have to wait long . )hell , that\&#39;s what i do every day .&#39;
</pre></div>
</div>
</div>
</div>
<p><em>a fully loaded entertainment review - website coming in july !&gt;from ace ventura to truman burbank , jim carrey has run the whole gamut of comic , yet sympathetic , characters .1996’s the cable guy was supposed to be his big ” breakthrough ” role from zany humor into darker , more dramatic acting .as most everyone knows , the results were , well , less-than-stellar .not only did the film not do so hot at the box office , but it was also panned by critics .as far as i know , gene siskel and i are the only ones willing to admit that we dug it .the first time i saw the cable guy , in theatres , i was in super critic-mode , and didn’t really like it .however , due to the fact that hbo shows the movie every single day , i’ve had time to lean back , relax , and take in the film .and to my surprise , it grew on me .the plot is rather simple : broderick plays a guy named steven who befriends his cable guy , played by carrey , then is stalked by him when steven tries to break off the relationship .see , steven’s been having some problems with his girlfriend , robin ( leslie mann ) , and he doesn’t think he has any more room in his life for a new friend .also , some of the cable guy’s antics have been creeping him out .carrey , as the cable guy , gives steven various aliases , which later we find out are all tv characters : larry tate , chip douglas , ricky ricardo , etc . he apparently lives in his cable van , and while many critics didn’t enjoy this newer , darker , less-manic performance from carrey , i thought it was interesting and rather well-done .for me , its not the movie as a whole that’s enjoyable , but rather several individual scenes : a karaoke jam at steven’s apartment , a medieval fight at a theme restaurant , and a bathroom beating ( a la liar , liar ) , just to name a few .perhaps the fact that more of carrey’s humorous side comes out during these scenes is what makes them so funny .and if you really want to see something , you’ve got to hear his version of jefferson airplane’s ” somebody to love ” , sung at the aformentioned karaoke jam .the cable guy has its bad spots , like most any movie .i didn’t particularly like steven’s girlfriend , and i felt that more focus should have been used on the relationship between steven and his best friend .also , the ending , while having you fooled for a moment , is rather contrived , and somewhat dissapointing .still , i found the cable guy to be a worthwhile venture ; if you’re at the video store and can’t think of anything to rent , i suggest you try it out .or if you have hbo , just wait till it comes on ( you won’t have to wait long . )hell , that’s what i do every day .</em></p>
<p>For this review of The Cable Guy I think that because the reviewer spends much of his time actually pointing out the flaws with the movie, the two more primitive models are confused by it. There is a lot of negative language. I feel that once again, BERT is able to pick up more of the context, that the reviewer is essentially saying that the movie is worthwhile despite all of the flaws</p>
</div>
<div class="section" id="what-the-more-primitive-2-models-get-right-that-bert-does-not">
<h1>What the More Primitive 2 Models get Right that BERT does not<a class="headerlink" href="#what-the-more-primitive-2-models-get-right-that-bert-does-not" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">common_to_NB_LR</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">incorrects_lr</span><span class="p">:</span>
        <span class="n">common_to_NB_LR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_BERT_not_NB_LR</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">common_to_NB_LR</span><span class="p">:</span>
        <span class="n">in_BERT_not_NB_LR</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_BERT_not_NB_LR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 10, 24, 25, 44, 91, 118, 135, 157, 171]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">24</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       to clean up ? &quot; the world in gridlock&#39;d is jus...
Name: 24, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">24</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;call 911 for the cliche police if you must , but the eyes are the window to the soul .the finest actors working in films are those who can command the screen with a gaze : paul newman , ralph fiennes , anthony hopkins , morgan freeman .you look at these men on screen and you can tell without them saying a word that there is something going on in their minds , that the characters they play are real human beings .we will never have a chance to discover if tupac shakur could have been a great actor , but he had that unique quality in his eyes .in gridlock\&#39;d , an oddly effective combination of gritty drama and social satire , shakur and his co-star tim roth take sketchy characters and make them exciting to watch through the pure energy of their talent and chemistry .shakur and roth play ezekiel &quot; spoon &quot; whitmore and alexander &quot; stretch &quot; rome , two detroit buddies who share a spoken word/jazz trio , an apartment and a drug addiction with cookie ( thandie newton ) .when a new year\&#39;s eve party ends with cookie comatose after a drug overdose , spoon and stretch begin to wonder if they are living on borrowed time .they soon make a new year\&#39;s resolution to get into rehab , but that proves to be easier said than done .as though the temptation to fix were not hindrance enough , spoon and stretch also find their attempts to get clean hitting a road block of bureaucracy , confusion and red tape .the government might be the least of their obstacles , however , as they find themselves suspects in the murder of a drug dealer , and on the run from a nasty thug ( vondie curtis hall ) .in order for you to buy into gridlock\&#39;d at all , you have to accept it as a surreal odyssey rather than as urban realism ; unless spoon and stretch sleep through an entire day at the hospital after bringing in cookie , they are going to government offices on new year\&#39;s day , in which case they should be thankful they get any help at all .gridlock\&#39;d may actually be a response to the fatuous social commentary of another urban odyssey , 1991\&#39;s falling down , which found a besieged middle class white male venting his righteous anger against the system during a trek through inner city los angeles .in falling down , michael douglas\&#39; d-fens ( the character\&#39;s personalized license plate , echoed in gridlock\&#39;d by the drug lord d-reper\&#39;s plates ) whips out a gun because he can\&#39;t get breakfast at mcdonald\&#39;s ; in gridlock\&#39;d , spoon and stretch are unarmed against the demands placed on them before they can get into a rehab center .and where the unhinged d-fens became a heroic surrogate for audiences , writer/director vondie curtis hall refuses to let spoon and stretch off the hook for their own part in the situation .one bureaucrat responds to a tirade from stretch with the question , &quot; do you expect the world to stop . . . justbecause you picked _today_ to clean up ? &quot;the world in gridlock\&#39;d is just as frustrating as the world in falling down , but the cathartic moments yield no easy answers this time .hall has some interesting things to say about what we expect from the system , but perhaps not enough of them .a significant chunk of gridlock\&#39;d is devoted to spoon and stretch\&#39;s flight from d-reper and from the police , and those sub-plots serve up some thoroughly predictable moments .in one scene , stretch scares off d-reper by getting chummy with a police officer ; another presents that old chestnut of the two mistakenly-suspected heroes in a public place watching a television news report of the crime which shows their pictures .the entire sequence of events seems designed merely as an excuse to get spoon and stretch running , while the other primary plot has them standing in line or sitting down much of the time .hall also plays with gratuitous inserts of drug paraphernalia and flashbacks to the day before the film\&#39;s main events , perhaps making a particular effort to point out the talent the characters are wasting through self-destructive behavior .oh , the irony of it .tupac shakur made a career in music and movies playing the hard case , and living the life to back it up .in gridlock\&#39;d , shakur gets the chance to play someone who has seen enough of the way his life could go to know that it scares him .spoon is an idea for a character at best as written by hall , but shakur displays an intelligence and survival instinct which struggle with his addiction .mostly it comes through those eyes , eyes with none of the hardness you might expect from the infamous gangsta .it is spoon who plays conscience to stretch\&#39;s pure appetite , and roth plays stretch with a gleeful self-destructiveness ( he reveals that he is hiv positive even as he is preparing to shoot up again ) which is as much an obstacle to spoon\&#39;s goal as any agency or enemy .gridlock\&#39;d\&#39;s most cruelly comic scene finds stretch &quot; helping &quot; spoon get into an emergency room by repeatedly stabbing him with a tiny pocket knife , and it becomes an appropriate symbol for how the company he keeps has slowly drained the life out of him .with friends like that , spoon doesn\&#39;t need enemies , and shakur looks at stretch with the tired eyes of a man who has seen too much .the tragedy now is that we won\&#39;t get more chances to see those eyes again .&#39;
</pre></div>
</div>
</div>
</div>
<p><em>call 911 for the cliche police if you must , but the eyes are the window to the soul .the finest actors working in films are those who can command the screen with a gaze : paul newman , ralph fiennes , anthony hopkins , morgan freeman .you look at these men on screen and you can tell without them saying a word that there is something going on in their minds , that the characters they play are real human beings .we will never have a chance to discover if tupac shakur could have been a great actor , but he had that unique quality in his eyes .in gridlock’d , an oddly effective combination of gritty drama and social satire , shakur and his co-star tim roth take sketchy characters and make them exciting to watch through the pure energy of their talent and chemistry .shakur and roth play ezekiel ” spoon ” whitmore and alexander ” stretch ” rome , two detroit buddies who share a spoken word/jazz trio , an apartment and a drug addiction with cookie ( thandie newton ) .when a new year’s eve party ends with cookie comatose after a drug overdose , spoon and stretch begin to wonder if they are living on borrowed time .they soon make a new year’s resolution to get into rehab , but that proves to be easier said than done .as though the temptation to fix were not hindrance enough , spoon and stretch also find their attempts to get clean hitting a road block of bureaucracy , confusion and red tape .the government might be the least of their obstacles , however , as they find themselves suspects in the murder of a drug dealer , and on the run from a nasty thug ( vondie curtis hall ) .in order for you to buy into gridlock’d at all , you have to accept it as a surreal odyssey rather than as urban realism ; unless spoon and stretch sleep through an entire day at the hospital after bringing in cookie , they are going to government offices on new year’s day , in which case they should be thankful they get any help at all .gridlock’d may actually be a response to the fatuous social commentary of another urban odyssey , 1991’s falling down , which found a besieged middle class white male venting his righteous anger against the system during a trek through inner city los angeles .in falling down , michael douglas’ d-fens ( the character’s personalized license plate , echoed in gridlock’d by the drug lord d-reper’s plates ) whips out a gun because he can’t get breakfast at mcdonald’s ; in gridlock’d , spoon and stretch are unarmed against the demands placed on them before they can get into a rehab center .and where the unhinged d-fens became a heroic surrogate for audiences , writer/director vondie curtis hall refuses to let spoon and stretch off the hook for their own part in the situation .one bureaucrat responds to a tirade from stretch with the question , ” do you expect the world to stop … justbecause you picked <em>today</em> to clean up ? “the world in gridlock’d is just as frustrating as the world in falling down , but the cathartic moments yield no easy answers this time .hall has some interesting things to say about what we expect from the system , but perhaps not enough of them .a significant chunk of gridlock’d is devoted to spoon and stretch’s flight from d-reper and from the police , and those sub-plots serve up some thoroughly predictable moments .in one scene , stretch scares off d-reper by getting chummy with a police officer ; another presents that old chestnut of the two mistakenly-suspected heroes in a public place watching a television news report of the crime which shows their pictures .the entire sequence of events seems designed merely as an excuse to get spoon and stretch running , while the other primary plot has them standing in line or sitting down much of the time .hall also plays with gratuitous inserts of drug paraphernalia and flashbacks to the day before the film’s main events , perhaps making a particular effort to point out the talent the characters are wasting through self-destructive behavior .oh , the irony of it .tupac shakur made a career in music and movies playing the hard case , and living the life to back it up .in gridlock’d , shakur gets the chance to play someone who has seen enough of the way his life could go to know that it scares him .spoon is an idea for a character at best as written by hall , but shakur displays an intelligence and survival instinct which struggle with his addiction .mostly it comes through those eyes , eyes with none of the hardness you might expect from the infamous gangsta .it is spoon who plays conscience to stretch’s pure appetite , and roth plays stretch with a gleeful self-destructiveness ( he reveals that he is hiv positive even as he is preparing to shoot up again ) which is as much an obstacle to spoon’s goal as any agency or enemy .gridlock’d’s most cruelly comic scene finds stretch ” helping ” spoon get into an emergency room by repeatedly stabbing him with a tiny pocket knife , and it becomes an appropriate symbol for how the company he keeps has slowly drained the life out of him .with friends like that , spoon doesn’t need enemies , and shakur looks at stretch with the tired eyes of a man who has seen too much .the tragedy now is that we won’t get more chances to see those eyes again .</em></p>
<p>Once more BERT has predicted that this review is negative when it is, in fact, positive. This is quite a long review, with over 900 words. This means that for BERT (max sequence length 512), it has no awareness of the majority of the first half of the document. Once again there are many negative words in use throughout.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1_512_12</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">118</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     neg
pred                                                     pos
correct                                                   no
text       two leads are together by film&#39;s end . now if ...
Name: 118, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">118</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
    <span class="n">review</span> <span class="o">=</span> <span class="n">review</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
<span class="n">review</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;the law of crowd pleasing romantic movies states that the two leads must end up together by film\&#39;s end .if you\&#39;re not familiar with this law , then maybe you\&#39;ve seen the trailer for this film which shows that the two leads are together by film\&#39;s end .now if you\&#39;re a regular reader of mine , you\&#39;ve heard me say this countless times : you know how drive me crazy is going to end , but is the journey to get to that ending worth it ?no , it definitely is not .melissa joan hart ( from abc\&#39;s &quot; sabrina , the teenage witch &quot; ) likes a hunky stud on the basketball team .adrien grenier is her grungy neighbor who\&#39;s just broken up with his activist girlfriend .apparently he wants to make his ex-girlfriend jealous enough to take him back , and she wants someone to take her to the big year end dance .so the two pretend to date for some reason , but only after hart gives grenier a bath to turn him into a hunky stud .will grenier like his new popularity and turn on his friends ?will this crazy scheme work ?do i care ?the teen comedy resurgence of late has been surprisingly good in terms of comedy .what makes movies like can\&#39;t hardly wait and 10 things i hate about you work ( and to a lesser extent , she\&#39;s all that and never been kissed ) is because the writers of those films seem to realize that high school is a joke and write their scripts accordingly .i don\&#39;t know what the writer\&#39;s intention was with drive me crazy .there was some smart comedy in those films to make the obvious endings worth getting to .here there\&#39;s nothing . . .just teens whining about who\&#39;s going to take them to the big dance .do me a favor kids , go get a job or something . . .just shut the hell up .in all honesty , the best part of this film is the end credits .now normally when i say that it\&#39;s followed with the joke &quot; . . . because the movie is finally over . &quot;in this case though the end credits really are the most entertaining part of the film .after the obligatory second playing of britney spears\&#39; titular song , there\&#39;s a quick commercial jingle for a burger joint the kids in the film hang out in and a brief rendition of the school song for their high school .nothing great , but more entertaining than anything in the 90 minutes which preceded them .sci-fi fans take note : there are brief appearances from stephen collins ( star trek : the motion picture ) and faye grant ( the tv miniseries &quot; v &quot; and &quot; v : the final battle &quot; ) .[pg-13]&#39;
</pre></div>
</div>
</div>
</div>
<p><em>the law of crowd pleasing romantic movies states that the two leads must end up together by film’s end .if you’re not familiar with this law , then maybe you’ve seen the trailer for this film which shows that the two leads are together by film’s end .now if you’re a regular reader of mine , you’ve heard me say this countless times : you know how drive me crazy is going to end , but is the journey to get to that ending worth it ?no , it definitely is not .melissa joan hart ( from abc’s ” sabrina , the teenage witch ” ) likes a hunky stud on the basketball team .adrien grenier is her grungy neighbor who’s just broken up with his activist girlfriend .apparently he wants to make his ex-girlfriend jealous enough to take him back , and she wants someone to take her to the big year end dance .so the two pretend to date for some reason , but only after hart gives grenier a bath to turn him into a hunky stud .will grenier like his new popularity and turn on his friends ?will this crazy scheme work ?do i care ?the teen comedy resurgence of late has been surprisingly good in terms of comedy .what makes movies like can’t hardly wait and 10 things i hate about you work ( and to a lesser extent , she’s all that and never been kissed ) is because the writers of those films seem to realize that high school is a joke and write their scripts accordingly .i don’t know what the writer’s intention was with drive me crazy .there was some smart comedy in those films to make the obvious endings worth getting to .here there’s nothing …just teens whining about who’s going to take them to the big dance .do me a favor kids , go get a job or something …just shut the hell up .in all honesty , the best part of this film is the end credits .now normally when i say that it’s followed with the joke ” … because the movie is finally over . “in this case though the end credits really are the most entertaining part of the film .after the obligatory second playing of britney spears’ titular song , there’s a quick commercial jingle for a burger joint the kids in the film hang out in and a brief rendition of the school song for their high school .nothing great , but more entertaining than anything in the 90 minutes which preceded them .sci-fi fans take note : there are brief appearances from stephen collins ( star trek : the motion picture ) and faye grant ( the tv miniseries ” v ” and ” v : the final battle ” ) .[pg-13]</em></p>
<p>In this case the model is predicting that the review is positive when the label is actually negative. Sentences like “the teen comedy resurgence of late has been surprisingly good in terms of comedy” are likely to confuse BERT even though it’s being used to compare what this reviewer things is a bad movie to good movies. There are also instances of “entertaining” and “more entertaining” which again may confuse the model. The review is quite snarky which can be quite subtle and make it difficult for a model to pick up the context. BERT cuts some of the start of this review too including “is the journey to get to that ending worth it ? no , it definitely is not”. It’s not clear whether it would have taken this into account but it seems plausible.</p>
<p>I decided at this point to check how many of the reviews that BERT predicts incorrectly are above the token limit of 512</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">over_512</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">in_BERT_not_NB_LR</span><span class="p">:</span>
    <span class="n">word_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">review</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="n">value</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">word_count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Review no. </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1"> has </span><span class="si">{</span><span class="n">word_count</span><span class="si">}</span><span class="s1"> words&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">word_count</span> <span class="o">&gt;</span> <span class="mi">512</span><span class="p">:</span>
        <span class="n">over_512</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Percentage of reviews above BERT token limit: </span><span class="si">{</span><span class="n">over_512</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">in_BERT_not_NB_LR</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Review no. 1 has 769 words
Review no. 10 has 966 words
Review no. 24 has 995 words
Review no. 25 has 858 words
Review no. 44 has 842 words
Review no. 91 has 480 words
Review no. 118 has 501 words
Review no. 135 has 626 words
Review no. 157 has 225 words
Review no. 171 has 836 words

Percentage of reviews above BERT token limit: 70.00%
</pre></div>
</div>
</div>
</div>
<p>We can see that a full 70% of the reviews that BERT has struggled to correctly classify contain a significant amount of tokens that were pruned from the beginning of the review and never seen by the model. This is likely to be quite damaging to BERT’s ability to accurately classify them.</p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="256_BERT_NEGATION.html" title="previous page">BERT with Negation Handling</a>
    <a class='right-next' id="next-link" href="CONCLUSION.html" title="next page">Conclusion</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>