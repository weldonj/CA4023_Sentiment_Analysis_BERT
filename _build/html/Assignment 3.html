
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Naive Bayes &#8212; CA4023 Assignment 3 - BERT Sentiment Analysis - John Weldon</title>
    
  <link rel="stylesheet" href="_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="index.html">
  
  <img src="_static/bert.jpeg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">CA4023 Assignment 3 - BERT Sentiment Analysis - John Weldon</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro.html">
   OVERVIEW
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Baseline BERT
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT.html">
   BERT as given in assignment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT with 512 sequence length
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT.html">
   BERT with 512 Max Sequence Length
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT with 512 sequence length and 12 Epochs
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT_12.html">
   BERT with 512 Max Sequence Length and 12 Epochs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="512_BERT_12.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Baseline BERT with Negation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT_NEGATION.html">
   BERT with Negation Handling
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="256_BERT_NEGATION.html#how-it-performs">
   How it performs
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  BERT vs Assignment 2 Performance
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="BERT_Ass2.html">
   Overview of all the BERT models vs the Assignment 2 models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BERT_Ass2.html#what-do-all-three-models-struggle-with">
   What do all three models struggle with?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BERT_Ass2.html#common-errors-to-all-three-models">
   Common Errors to all Three Models
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BERT_Ass2.html#what-bert-gets-right-that-the-other-2-do-not">
   What BERT gets right that the other 2 do not
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="BERT_Ass2.html#what-the-more-primitive-2-models-get-right-that-bert-does-not">
   What the More Primitive 2 Models get Right that BERT does not
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Conclusion and Learning Outcomes
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="CONCLUSION.html">
   Conclusion
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="CONCLUSION.html#learning-outcome">
   Learning Outcome
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Assignment 3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/Assignment 3.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="k">class</span> <span class="nc">PL04DataLoader_Part_1</span><span class="p">:</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>
    
    <span class="k">def</span> <span class="nf">get_labelled_dataset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Compile a fold of the data set</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">dataset</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">,</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">document</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_documents</span><span class="p">(</span>
                <span class="n">fold</span> <span class="o">=</span> <span class="n">fold</span><span class="p">,</span>
                <span class="n">label</span> <span class="o">=</span> <span class="n">label</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="n">dataset</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">document</span><span class="p">,</span> <span class="n">label</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">dataset</span>
    
    <span class="k">def</span> <span class="nf">get_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Enumerate the raw contents of all data set files.</span>
<span class="sd">            Args:</span>
<span class="sd">                data_dir: relative or absolute path to the data set folder</span>
<span class="sd">                fold: which fold to load (0 to n_folds-1)</span>
<span class="sd">                label: &#39;pos&#39; or &#39;neg&#39; to</span>
<span class="sd">                    select data with positive or negative sentiment</span>
<span class="sd">                    polarity</span>
<span class="sd">            Return:</span>
<span class="sd">                List of tokenised documents, each a list of sentences</span>
<span class="sd">                that in turn are lists of tokens</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

<span class="k">class</span> <span class="nc">PL04DataLoader</span><span class="p">(</span><span class="n">PL04DataLoader_Part_1</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">get_xval_splits</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; Split data with labels for cross-validation</span>
<span class="sd">            returns a list of k pairs (training_data, test_data)</span>
<span class="sd">            for k cross-validation</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># load the folds</span>
        <span class="n">folds</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">folds</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_labelled_dataset</span><span class="p">(</span>
                <span class="n">fold</span> <span class="o">=</span> <span class="n">i</span>
            <span class="p">))</span>
        <span class="c1"># create training-test splits</span>
        <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="n">test_data</span> <span class="o">=</span> <span class="n">folds</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">training_data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">):</span>
                <span class="n">ij1</span> <span class="o">=</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span>
                <span class="k">assert</span> <span class="n">ij1</span> <span class="o">!=</span> <span class="n">i</span>
                <span class="n">training_data</span> <span class="o">=</span> <span class="n">training_data</span> <span class="o">+</span> <span class="n">folds</span><span class="p">[</span><span class="n">ij1</span><span class="p">]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">training_data</span><span class="p">,</span> <span class="n">test_data</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">retval</span>
    
<span class="k">class</span> <span class="nc">PL04DataLoaderFromStream</span><span class="p">(</span><span class="n">PL04DataLoader</span><span class="p">):</span>
        
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tgz_stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">counter</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">with</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="s1">&#39;r|gz&#39;</span><span class="p">,</span>
            <span class="n">fileobj</span> <span class="o">=</span> <span class="n">tgz_stream</span>
        <span class="p">)</span> <span class="k">as</span> <span class="n">tar_archive</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tar_member</span> <span class="ow">in</span> <span class="n">tar_archive</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">counter</span> <span class="o">==</span> <span class="mi">2000</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="n">path_components</span> <span class="o">=</span> <span class="n">tar_member</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
                <span class="n">filename</span> <span class="o">=</span> <span class="n">path_components</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;cv&#39;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;.txt&#39;</span><span class="p">)</span> \
                <span class="ow">and</span> <span class="s1">&#39;_&#39;</span> <span class="ow">in</span> <span class="n">filename</span><span class="p">:</span>
                    <span class="n">label</span> <span class="o">=</span> <span class="n">path_components</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
                    <span class="n">fold</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">filename</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">key</span> <span class="o">=</span> <span class="p">(</span><span class="n">fold</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="n">tar_archive</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="n">tar_member</span><span class="p">)</span>
                    <span class="n">document</span> <span class="o">=</span> <span class="p">[</span>
                        <span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
                    <span class="p">]</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
                    <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
            
    <span class="k">def</span> <span class="nf">get_documents</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fold</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[(</span><span class="n">fold</span><span class="p">,</span> <span class="n">label</span><span class="p">)]</span>

<span class="k">class</span> <span class="nc">PL04DataLoaderFromTGZ</span><span class="p">(</span><span class="n">PL04DataLoaderFromStream</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_path</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">tgz_stream</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">tgz_stream</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dir_entries</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">()</span>
<span class="n">dir_entries</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_loader</span> <span class="o">=</span> <span class="n">PL04DataLoaderFromTGZ</span><span class="p">(</span><span class="s1">&#39;data.tar.gz&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># test &quot;get_documents()&quot;</span>

<span class="k">def</span> <span class="nf">get_document_preview</span><span class="p">(</span><span class="n">document</span><span class="p">,</span> <span class="n">max_length</span> <span class="o">=</span> <span class="mi">72</span><span class="p">):</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">reached_limit</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">document</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">max_length</span><span class="p">:</span>
                <span class="n">reached_limit</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
            <span class="n">s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">reached_limit</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="s1">&#39;|&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    
<span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="s1">&#39;pos neg&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;== </span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1"> ==&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;doc sentences start of first sentence&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">document</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data_loader</span><span class="o">.</span><span class="n">get_documents</span><span class="p">(</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">label</span>
    <span class="p">)):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%3d</span><span class="s1"> </span><span class="si">%7d</span><span class="s1">   </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span>
            <span class="n">index</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">document</span><span class="p">),</span> <span class="n">get_document_preview</span><span class="p">(</span><span class="n">document</span><span class="p">)</span>
        <span class="p">))</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">break</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>== pos ==
doc sentences start of first sentence
  0      25   films|adapted|from|comic|books|have|had|plenty|of|success|,|whether
  1      39   every|now|and|then|a|movie|comes|along|from|a|suspect|studio|,|with
  2      19   you&#39;ve|got|mail|works|alot|better|than|it|deserves|to|.|in|order|to|make
  3      42   &quot;|jaws|&quot;|is|a|rare|film|that|grabs|your|attention|before|it|shows|you|a
  4      25   moviemaking|is|a|lot|like|being|the|general|manager|of|an|nfl|team|in
== neg ==
doc sentences start of first sentence
  0      35   plot|:|two|teen|couples|go|to|a|church|party|,|drink|and|then|drive|.
  1      13   the|happy|bastard&#39;s|quick|movie|review|damn|that|y2k|bug|.|it&#39;s|got|a
  2      23   it|is|movies|like|these|that|make|a|jaded|movie|viewer|thankful|for|the
  3      19   &quot;|quest|for|camelot|&quot;|is|warner|bros|.|&#39;|first|feature-length|,
  4      37   synopsis|:|a|mentally|unstable|man|undergoing|psychotherapy|saves|a|boy
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># test &quot;get_xval_splits()&quot;</span>

<span class="n">splits</span> <span class="o">=</span> <span class="n">data_loader</span><span class="o">.</span><span class="n">get_xval_splits</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tr-size te-size (number of documents)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">xval_tr_data</span><span class="p">,</span> <span class="n">xval_te_data</span> <span class="ow">in</span> <span class="n">splits</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%7d</span><span class="s1"> </span><span class="si">%7d</span><span class="s1">&#39;</span> <span class="o">%</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">xval_tr_data</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">xval_te_data</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tr-size te-size (number of documents)
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
   1800     200
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PolarityPredictorInterface</span><span class="p">:</span>

    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_with_labels</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PolarityPredictorWithVocabulary</span><span class="p">(</span><span class="n">PolarityPredictorInterface</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_with_labels</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_vocab</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_to_vocab_from_data</span><span class="p">(</span><span class="n">data_with_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">finalise_vocab</span><span class="p">()</span>
        <span class="n">tr_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span>
            <span class="n">data_with_labels</span>
        <span class="p">)</span>
        <span class="n">tr_targets</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data_with_labels</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">train_model_on_features</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">reset_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">add_to_vocab_from_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">document</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">document</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">finalise_vocab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vocab</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
        <span class="c1"># create reverse map for fast token lookup</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">token</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="n">index</span>
        
    <span class="k">def</span> <span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
    
    <span class="k">def</span> <span class="nf">get_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">label2index</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
        
    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span>

<span class="k">class</span> <span class="nc">PolarityPredictorWithBagOfWords_01</span><span class="p">(</span><span class="n">PolarityPredictorWithVocabulary</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clip_counts</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">clip_counts</span> <span class="o">=</span> <span class="n">clip_counts</span>
        
    <span class="k">def</span> <span class="nf">extract_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="c1"># create numpy array of required size</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vocab</span><span class="p">)</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">features</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">rows</span><span class="p">,</span> <span class="n">columns</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>        
        <span class="c1"># populate feature matrix</span>
        <span class="k">for</span> <span class="n">row</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">document</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="n">document</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">sentence</span><span class="p">:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">token2index</span><span class="p">[</span><span class="n">token</span><span class="p">]</span>
                    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                        <span class="c1"># token not in vocab</span>
                        <span class="c1"># --&gt; skip this token</span>
                        <span class="c1"># --&gt; continue with next token</span>
                        <span class="k">continue</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">clip_counts</span><span class="p">:</span>
                        <span class="n">features</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">features</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">features</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PolarityPredictorWithBagOfWords</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords_01</span><span class="p">):</span>
 
    <span class="k">def</span> <span class="nf">get_targets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39; create column vector with target labels</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1"># prepare target vector</span>
        <span class="n">targets</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">numpy</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">label</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">:</span>
                <span class="n">targets</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">targets</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="naive-bayes">
<h1>Naive Bayes<a class="headerlink" href="#naive-bayes" title="Permalink to this headline">¶</a></h1>
<p>These next few cells set up the baseline Naive Bayes model that we were supplied with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.naive_bayes</span> <span class="kn">import</span> <span class="n">MultinomialNB</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="k">class</span> <span class="nc">PolarityPredictorBowNB</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="c1"># pass numpy array to sklearn to train NB</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">MultinomialNB</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">get_confusion_matrix</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># use numpy to get predictions</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="c1"># restore labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">is_positive</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">y_pred</span><span class="p">):</span>

            <span class="k">if</span> <span class="n">is_positive</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_accuracy</span> <span class="ow">or</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">get_accuracy</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">labels</span><span class="p">,</span> <span class="n">y_pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># first functionality test</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">PolarityPredictorBowNB</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corrects</span> <span class="o">=</span> <span class="n">y_true</span><span class="o">==</span><span class="n">pred</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incorrects_nb</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">answer</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corrects</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">answer</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
        <span class="n">incorrects_nb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incorrects_nb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[0,
 4,
 19,
 22,
 25,
 28,
 34,
 40,
 44,
 49,
 50,
 54,
 55,
 57,
 58,
 72,
 75,
 80,
 82,
 89,
 90,
 93,
 98,
 103,
 108,
 110,
 124,
 125,
 134,
 135,
 141,
 142,
 154,
 159,
 160,
 175,
 176,
 186,
 190,
 194,
 197]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>

<span class="k">class</span> <span class="nc">PolarityPredictorBowLR</span><span class="p">(</span><span class="n">PolarityPredictorWithBagOfWords</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">train_model_on_features</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">):</span>
        <span class="c1"># pass numpy array to sklearn to train Logistic Regression</span>
        <span class="c1"># iterations set to 1000 as default of 100 didn&#39;t guarantee convergence with our data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">tr_features</span><span class="p">,</span> <span class="n">tr_targets</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">get_accuracy</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">get_confusion_matrix</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">):</span>
        <span class="n">features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">extract_features</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="c1"># use numpy to get predictions</span>
        <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
        <span class="c1"># restore labels</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">is_positive</span> <span class="ow">in</span> <span class="n">y_pred</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">is_positive</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;pos&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">labels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">get_accuracy</span> <span class="ow">or</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
            <span class="n">retval</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>
            <span class="n">y_true</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_targets</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">get_accuracy</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">get_confusion_matrix</span><span class="p">:</span>
                <span class="n">retval</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">metrics</span><span class="o">.</span><span class="n">confusion_matrix</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
                <span class="p">)</span>
            <span class="k">return</span> <span class="n">retval</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">labels</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">PolarityPredictorBowLR</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bert_256_files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">bert_256_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;256_BERT/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_pred.txt&#39;</span><span class="p">)</span>


<span class="n">bert_512_files</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">bert_512_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;512_BERT/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_pred_512.txt&#39;</span><span class="p">)</span>
    

<span class="n">bert_512_12_files</span> <span class="o">=</span> <span class="p">[]</span>
    
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">11</span><span class="p">):</span>
    <span class="n">bert_512_12_files</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;512_12_BERT/</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">_pred_512_12.txt&#39;</span><span class="p">)</span>    

    
<span class="n">bert_256_neg_files</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;256_BERT_NEG/1_pred_negation.txt&#39;</span><span class="p">]</span>

    
<span class="n">c_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;gold&#39;</span><span class="p">,</span><span class="s1">&#39;pred&#39;</span><span class="p">,</span><span class="s1">&#39;correct&#39;</span><span class="p">,</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df4</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df5</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df6</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df7</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df8</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df9</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df10</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>

<span class="n">df1_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df2_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df3_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df4_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df5_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df6_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df7_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df8_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df9_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df10_512</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>

<span class="n">df1_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df2_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df3_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df4_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df5_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df6_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df7_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df8_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df9_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>
<span class="n">df10_512_12</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>

<span class="n">df1_neg</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">c_names</span><span class="p">)</span>

<span class="n">dataframes_256</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span><span class="n">df2</span><span class="p">,</span><span class="n">df3</span><span class="p">,</span><span class="n">df4</span><span class="p">,</span><span class="n">df5</span><span class="p">,</span><span class="n">df6</span><span class="p">,</span><span class="n">df7</span><span class="p">,</span><span class="n">df8</span><span class="p">,</span><span class="n">df9</span><span class="p">,</span><span class="n">df10</span><span class="p">]</span>

<span class="n">dataframes_512</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1_512</span><span class="p">,</span><span class="n">df2_512</span><span class="p">,</span><span class="n">df3_512</span><span class="p">,</span><span class="n">df4_512</span><span class="p">,</span><span class="n">df5_512</span><span class="p">,</span><span class="n">df6_512</span><span class="p">,</span><span class="n">df7_512</span><span class="p">,</span><span class="n">df8_512</span><span class="p">,</span><span class="n">df9_512</span><span class="p">,</span><span class="n">df10_512</span><span class="p">]</span>

<span class="n">dataframes_512_12</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1_512_12</span><span class="p">,</span><span class="n">df2_512_12</span><span class="p">,</span><span class="n">df3_512_12</span><span class="p">,</span><span class="n">df4_512_12</span><span class="p">,</span><span class="n">df5_512_12</span><span class="p">,</span><span class="n">df6_512_12</span><span class="p">,</span><span class="n">df7_512_12</span><span class="p">,</span><span class="n">df8_512_12</span><span class="p">,</span><span class="n">df9_512_12</span><span class="p">,</span><span class="n">df10_512_12</span><span class="p">]</span>

<span class="n">dataframes_256_neg</span> <span class="o">=</span> <span class="p">[</span><span class="n">df1_neg</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">create_dfs</span><span class="p">(</span><span class="n">files</span><span class="p">,</span> <span class="n">df_list</span><span class="p">):</span>
    <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>

        <span class="c1">#dataframe = pd.DataFrame(columns=[&#39;index&#39;,&#39;gold&#39;,&#39;pred&#39;,&#39;correct&#39;,&#39;text&#39;])</span>
        <span class="n">processed_lines</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">files</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>

            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
                <span class="n">tokens</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="n">line_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
                <span class="n">temp_line</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>

                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="p">(</span><span class="n">line_length</span><span class="p">)):</span>
                    <span class="n">temp_line</span> <span class="o">=</span> <span class="n">temp_line</span> <span class="o">+</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39; &#39;</span>

                <span class="n">processed_line</span> <span class="o">=</span> <span class="p">[</span><span class="n">tokens</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">tokens</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="n">tokens</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">temp_line</span><span class="p">]</span>
                <span class="n">processed_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">processed_line</span><span class="p">)</span>
                <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">count</span><span class="p">]</span> <span class="o">=</span> <span class="n">processed_line</span>
                <span class="n">count</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
    <span class="k">return</span><span class="p">(</span><span class="n">df_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dataframes_256</span> <span class="o">=</span> <span class="n">create_dfs</span><span class="p">(</span><span class="n">bert_256_files</span><span class="p">,</span> <span class="n">dataframes_256</span><span class="p">)</span>

<span class="n">dataframes_512</span> <span class="o">=</span> <span class="n">create_dfs</span><span class="p">(</span><span class="n">bert_512_files</span><span class="p">,</span> <span class="n">dataframes_512</span><span class="p">)</span>

<span class="n">dataframes_512_12</span> <span class="o">=</span> <span class="n">create_dfs</span><span class="p">(</span><span class="n">bert_512_12_files</span><span class="p">,</span> <span class="n">dataframes_512_12</span><span class="p">)</span>

<span class="n">dataframes_256_neg</span> <span class="o">=</span> <span class="n">create_dfs</span><span class="p">(</span><span class="n">bert_256_neg_files</span><span class="p">,</span> <span class="n">dataframes_256_neg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_f1</span><span class="p">(</span><span class="n">dataframe</span><span class="p">):</span>
    <span class="n">true_pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">true_neg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">false_pos</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">false_neg</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">corrects</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
            <span class="n">corrects</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
            <span class="n">true_pos</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="n">false_neg</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
            <span class="n">true_neg</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
            <span class="n">false_pos</span> <span class="o">+=</span> <span class="mi">1</span>
    
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">corrects</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_pos</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_neg</span><span class="p">)</span>
    <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">))</span>
    <span class="k">return</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span><span class="n">precision</span><span class="p">,</span><span class="n">recall</span><span class="p">,</span><span class="n">f1_score</span><span class="p">,</span><span class="n">errors</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_averages</span><span class="p">(</span><span class="n">df_list</span><span class="p">):</span>
    <span class="n">accuracies</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">precs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">recs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">f1s</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">errors_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="n">df_list</span><span class="p">:</span>    
        <span class="n">true_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">true_neg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">false_pos</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">false_neg</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">corrects</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;yes&#39;</span><span class="p">:</span>
                <span class="n">corrects</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
                <span class="n">true_pos</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
                <span class="n">false_neg</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span><span class="p">):</span>
                <span class="n">true_neg</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">elif</span> <span class="p">(</span><span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;neg&#39;</span> <span class="ow">and</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">iat</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
                <span class="n">false_pos</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">corrects</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
        <span class="n">accuracies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">accuracy</span><span class="p">)</span>
        
        <span class="n">precision</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_pos</span><span class="p">)</span>
        <span class="n">precs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">precision</span><span class="p">)</span>

        <span class="n">recall</span> <span class="o">=</span> <span class="n">true_pos</span><span class="o">/</span><span class="p">(</span><span class="n">true_pos</span> <span class="o">+</span> <span class="n">false_neg</span><span class="p">)</span>
        <span class="n">recs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">recall</span><span class="p">)</span>
        
        <span class="n">f1_score</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="p">((</span><span class="n">precision</span><span class="o">*</span><span class="n">recall</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">precision</span> <span class="o">+</span> <span class="n">recall</span><span class="p">))</span>
        <span class="n">f1s</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f1_score</span><span class="p">)</span>
        
        <span class="n">errors_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
        
    <span class="k">return</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">accuracies</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">precs</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">recs</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span><span class="nb">sum</span><span class="p">(</span><span class="n">f1s</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df_list</span><span class="p">),</span> <span class="n">errors_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">print_averages_get_errors</span><span class="p">(</span><span class="n">dataframes</span><span class="p">,</span> <span class="n">errorlist</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="n">acc</span><span class="p">,</span><span class="n">prec</span><span class="p">,</span><span class="n">rec</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="n">errors</span> <span class="o">=</span> <span class="n">get_averages</span><span class="p">(</span><span class="n">dataframes</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">errorlist</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">errors</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">dataframe</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dataframes</span><span class="p">):</span>
            <span class="n">scores</span> <span class="o">=</span> <span class="n">get_f1</span><span class="p">(</span><span class="n">dataframe</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cross validation </span><span class="si">{</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The accuracy is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The precision is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The recall is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The F1 score is </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The model got the following rows wrong </span><span class="si">{</span><span class="n">scores</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average accuracy is </span><span class="si">{</span><span class="n">acc</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average precision is </span><span class="si">{</span><span class="n">prec</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average recall is </span><span class="si">{</span><span class="n">rec</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The average F1 score is </span><span class="si">{</span><span class="n">f1</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#error_256 = print_averages_get_errors(dataframes_256, True)</span>
<span class="c1">#error_512 = print_averages_get_errors(dataframes_512, True)</span>
<span class="n">error_512_12</span> <span class="o">=</span> <span class="n">print_averages_get_errors</span><span class="p">(</span><span class="n">dataframes_512_12</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_512</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 10,
 24,
 25,
 40,
 44,
 50,
 56,
 82,
 83,
 91,
 106,
 118,
 134,
 135,
 136,
 157,
 159,
 171,
 173]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">error_256</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1,
 10,
 44,
 50,
 82,
 91,
 108,
 113,
 117,
 118,
 124,
 128,
 129,
 134,
 135,
 157,
 171,
 177,
 197,
 198]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error_256</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">error_256</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">error_512</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error_256</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
10
44
50
82
91
118
134
135
157
171
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span>
    <span class="k">if</span> <span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">error_256</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">error_512_12</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
24
25
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_averages</span><span class="p">(</span><span class="n">dataframes_256</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross validation 1
The accuracy is 90.00%
The precision is 87.04%
The recall is 94.00%
The F1 score is 90.38%
The model got the following rows wrong [1, 10, 44, 50, 82, 91, 108, 113, 117, 118, 124, 128, 129, 134, 135, 157, 171, 177, 197, 198]

Cross validation 2
The accuracy is 87.50%
The precision is 85.71%
The recall is 90.00%
The F1 score is 87.80%
The model got the following rows wrong [9, 14, 18, 50, 59, 62, 65, 78, 93, 94, 104, 105, 115, 118, 125, 137, 140, 142, 143, 146, 162, 167, 170, 177, 189]

Cross validation 3
The accuracy is 95.00%
The precision is 93.27%
The recall is 97.00%
The F1 score is 95.10%
The model got the following rows wrong [8, 44, 99, 100, 133, 142, 156, 162, 178, 196]

Cross validation 4
The accuracy is 91.00%
The precision is 90.20%
The recall is 92.00%
The F1 score is 91.09%
The model got the following rows wrong [14, 31, 36, 54, 83, 92, 94, 98, 105, 108, 109, 120, 153, 159, 161, 168, 181, 185]

Cross validation 5
The accuracy is 85.00%
The precision is 88.04%
The recall is 81.00%
The F1 score is 84.38%
The model got the following rows wrong [0, 5, 18, 19, 20, 26, 30, 32, 35, 36, 51, 55, 60, 64, 67, 91, 93, 95, 98, 109, 144, 155, 160, 167, 172, 186, 189, 191, 192, 199]

Cross validation 6
The accuracy is 89.00%
The precision is 93.33%
The recall is 84.00%
The F1 score is 88.42%
The model got the following rows wrong [1, 2, 7, 19, 32, 34, 39, 40, 41, 45, 63, 79, 80, 85, 90, 99, 102, 119, 147, 151, 158, 171]

Cross validation 7
The accuracy is 85.50%
The precision is 83.81%
The recall is 88.00%
The F1 score is 85.85%
The model got the following rows wrong [3, 6, 27, 32, 34, 43, 44, 55, 60, 65, 93, 99, 100, 104, 109, 117, 120, 122, 126, 135, 137, 145, 161, 166, 171, 182, 185, 187, 197]

Cross validation 8
The accuracy is 89.00%
The precision is 90.62%
The recall is 87.00%
The F1 score is 88.78%
The model got the following rows wrong [12, 17, 19, 21, 35, 40, 58, 61, 64, 81, 89, 90, 97, 109, 112, 117, 135, 142, 166, 172, 187, 191]

Cross validation 9
The accuracy is 88.50%
The precision is 88.89%
The recall is 88.00%
The F1 score is 88.44%
The model got the following rows wrong [16, 25, 42, 50, 52, 55, 56, 70, 74, 76, 82, 84, 101, 103, 126, 132, 144, 145, 151, 155, 176, 178, 190]

Cross validation 10
The accuracy is 92.50%
The precision is 88.99%
The recall is 97.00%
The F1 score is 92.82%
The model got the following rows wrong [47, 50, 63, 112, 117, 124, 128, 133, 167, 171, 186, 188, 190, 192, 195]

The average accuracy is 89.30%
The average precision is 88.99%
The average recall is 89.80%
The average F1 score is 89.31%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_averages</span><span class="p">(</span><span class="n">dataframes_512_12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross validation 1
The accuracy is 93.50%
The precision is 95.79%
The recall is 91.00%
The F1 score is 93.33%
The model got the following rows wrong [1, 4, 10, 24, 25, 44, 50, 82, 91, 118, 135, 157, 171]

Cross validation 2
The accuracy is 92.50%
The precision is 92.08%
The recall is 93.00%
The F1 score is 92.54%
The model got the following rows wrong [9, 18, 59, 62, 88, 93, 94, 104, 115, 125, 137, 142, 167, 177, 189]

Cross validation 3
The accuracy is 93.00%
The precision is 90.57%
The recall is 96.00%
The F1 score is 93.20%
The model got the following rows wrong [8, 30, 50, 99, 100, 107, 111, 121, 133, 137, 142, 156, 162, 178]

Cross validation 4
The accuracy is 92.50%
The precision is 92.93%
The recall is 92.00%
The F1 score is 92.46%
The model got the following rows wrong [7, 14, 21, 34, 70, 83, 94, 98, 105, 109, 120, 128, 131, 159, 181]

Cross validation 5
The accuracy is 88.50%
The precision is 89.69%
The recall is 87.00%
The F1 score is 88.32%
The model got the following rows wrong [0, 19, 20, 26, 30, 35, 36, 37, 51, 55, 67, 77, 98, 100, 109, 130, 144, 155, 162, 172, 189, 192, 199]

Cross validation 6
The accuracy is 93.50%
The precision is 97.80%
The recall is 89.00%
The F1 score is 93.19%
The model got the following rows wrong [2, 7, 34, 39, 41, 45, 63, 80, 85, 90, 99, 133, 171]

Cross validation 7
The accuracy is 90.50%
The precision is 89.32%
The recall is 92.00%
The F1 score is 90.64%
The model got the following rows wrong [6, 27, 32, 42, 43, 44, 49, 93, 100, 102, 109, 117, 118, 126, 145, 171, 177, 185, 197]

Cross validation 8
The accuracy is 90.00%
The precision is 87.74%
The recall is 93.00%
The F1 score is 90.29%
The model got the following rows wrong [35, 58, 61, 74, 89, 90, 92, 104, 109, 119, 129, 131, 132, 134, 135, 142, 169, 185, 196, 197]

Cross validation 9
The accuracy is 91.50%
The precision is 96.63%
The recall is 86.00%
The F1 score is 91.01%
The model got the following rows wrong [16, 19, 25, 40, 41, 50, 55, 56, 59, 76, 81, 82, 84, 93, 101, 103, 145]

Cross validation 10
The accuracy is 95.00%
The precision is 95.92%
The recall is 94.00%
The F1 score is 94.95%
The model got the following rows wrong [7, 29, 32, 40, 47, 63, 112, 121, 127, 141]

The average accuracy is 92.05%
The average precision is 92.85%
The average recall is 91.30%
The average F1 score is 91.99%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">print_averages</span><span class="p">(</span><span class="n">dataframes_512</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Cross validation 1
The accuracy is 90.00%
The precision is 90.82%
The recall is 89.00%
The F1 score is 89.90%
The model got the following rows wrong [1, 10, 24, 25, 40, 44, 50, 56, 82, 83, 91, 106, 118, 134, 135, 136, 157, 159, 171, 173]

Cross validation 2
The accuracy is 93.50%
The precision is 91.43%
The recall is 96.00%
The F1 score is 93.66%
The model got the following rows wrong [9, 59, 88, 94, 104, 115, 125, 137, 142, 146, 167, 177, 189]

Cross validation 3
The accuracy is 92.00%
The precision is 89.62%
The recall is 95.00%
The F1 score is 92.23%
The model got the following rows wrong [8, 30, 50, 62, 99, 100, 107, 121, 128, 133, 142, 147, 156, 162, 173, 178]

Cross validation 4
The accuracy is 87.50%
The precision is 87.88%
The recall is 87.00%
The F1 score is 87.44%
The model got the following rows wrong [7, 14, 21, 27, 28, 30, 34, 39, 70, 83, 85, 94, 98, 108, 109, 120, 121, 128, 131, 133, 159, 163, 179, 181, 191]

Cross validation 5
The accuracy is 87.50%
The precision is 88.66%
The recall is 86.00%
The F1 score is 87.31%
The model got the following rows wrong [0, 18, 19, 20, 26, 30, 35, 36, 37, 51, 55, 67, 77, 98, 100, 109, 130, 131, 144, 155, 162, 172, 189, 192, 199]

Cross validation 6
The accuracy is 93.50%
The precision is 93.94%
The recall is 93.00%
The F1 score is 93.47%
The model got the following rows wrong [2, 4, 7, 34, 79, 85, 99, 119, 124, 133, 143, 154, 171]

Cross validation 7
The accuracy is 90.50%
The precision is 87.16%
The recall is 95.00%
The F1 score is 90.91%
The model got the following rows wrong [6, 32, 43, 44, 93, 100, 102, 109, 117, 118, 122, 126, 145, 147, 150, 155, 171, 185, 197]

Cross validation 8
The accuracy is 89.00%
The precision is 86.11%
The recall is 93.00%
The F1 score is 89.42%
The model got the following rows wrong [21, 35, 58, 74, 89, 90, 92, 104, 108, 109, 119, 122, 129, 131, 132, 134, 135, 142, 169, 185, 196, 197]

Cross validation 9
The accuracy is 92.00%
The precision is 94.68%
The recall is 89.00%
The F1 score is 91.75%
The model got the following rows wrong [10, 16, 25, 41, 55, 56, 59, 76, 81, 82, 93, 101, 103, 105, 145, 186]

Cross validation 10
The accuracy is 96.00%
The precision is 98.94%
The recall is 93.00%
The F1 score is 95.88%
The model got the following rows wrong [7, 11, 29, 32, 36, 47, 63, 112]

The average accuracy is 91.15%
The average precision is 90.92%
The average recall is 91.60%
The average F1 score is 91.20%
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">incorrects_bert</span> <span class="o">=</span> <span class="n">scores</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">incorrects_bert</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(20, 41)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="ow">in</span> <span class="n">incorrects_bert</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">incorrects_nb</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>44
50
82
108
124
134
135
197
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">44</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;. jock\&#39;s airplane at the beginning of the film has the registration number &quot; ob-cpo &quot; . this is a reference to obi-wan and c-3po from george lucas\&#39; star wars ( 9 . 5/10 ) . also , the hieroglyphics in the well of souls include engravings of r2-d2 and c-3po . they can be seen on a post to the right of indy and sallah as they remove the ark . the script originally included a long fight between a swordsman and indiana with his whip . as legend has it , actor harrison ford was suffering diarrhea at the time , and asked if the scene could be shortened . spielberg said the only way he could shorten it was if indy pulled out his gun and just shot the guy . the entire crew laughed and that\&#39;s how it was filmed . when indy first falls in the well of souls and is face to face with the cobra , you can see the snake\&#39;s reflection on the glass dividing it and harrison ford , also some fingerprints and stuff like that . when indy is dragging along the ground , hanging onto the nazi soldier\&#39;s truck with the ark inside , you can see the pad that he\&#39;s being dragged on . &#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">44</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([[&#39;what&#39;,
   &#39;do&#39;,
   &#39;you&#39;,
   &#39;get&#39;,
   &#39;when&#39;,
   &#39;you&#39;,
   &#39;slap&#39;,
   &#39;together&#39;,
   &#39;a&#39;,
   &#39;movie&#39;,
   &#39;based&#39;,
   &#39;on&#39;,
   &#39;a&#39;,
   &#39;story&#39;,
   &#39;by&#39;,
   &#39;the&#39;,
   &#39;legendary&#39;,
   &#39;george&#39;,
   &#39;lucas&#39;,
   &#39;,&#39;,
   &#39;directed&#39;,
   &#39;by&#39;,
   &#39;virtuoso&#39;,
   &#39;director&#39;,
   &#39;steven&#39;,
   &#39;spielberg&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;starring&#39;,
   &#39;one&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;biggest&#39;,
   &#39;box-office&#39;,
   &#39;stars&#39;,
   &#39;in&#39;,
   &#39;the&#39;,
   &#39;world&#39;,
   &#39;,&#39;,
   &#39;harrison&#39;,
   &#39;ford&#39;,
   &#39;?&#39;],
  [&#39;you&#39;,
   &#39;get&#39;,
   &#39;one&#39;,
   &quot;hot-fudge-rockin&#39;&quot;,
   &#39;good&#39;,
   &#39;time&#39;,
   &#39;,&#39;,
   &quot;that&#39;s&quot;,
   &#39;what&#39;,
   &#39;you&#39;,
   &#39;get&#39;,
   &#39;!&#39;,
   &#39;!&#39;,
   &#39;!&#39;],
  [&#39;plot&#39;,
   &#39;:&#39;,
   &#39;professor/archeologist&#39;,
   &#39;indiana&#39;,
   &#39;jones&#39;,
   &#39;sets&#39;,
   &#39;out&#39;,
   &#39;to&#39;,
   &#39;find&#39;,
   &#39;the&#39;,
   &#39;long-lost&#39;,
   &#39;mystical&#39;,
   &#39;ark&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;covenant&#39;,
   &#39;before&#39;,
   &#39;the&#39;,
   &#39;nazis&#39;,
   &#39;get&#39;,
   &#39;their&#39;,
   &#39;grubby&#39;,
   &#39;fingers&#39;,
   &#39;hands&#39;,
   &#39;on&#39;,
   &#39;it&#39;,
   &#39;.&#39;],
  [&#39;adventures&#39;,
   &#39;,&#39;,
   &#39;snakes&#39;,
   &#39;,&#39;,
   &#39;romance&#39;,
   &#39;and&#39;,
   &#39;mucho&#39;,
   &#39;action&#39;,
   &#39;ensues&#39;,
   &#39;.&#39;],
  [&#39;critique&#39;,
   &#39;:&#39;,
   &#39;astounding&#39;,
   &#39;movie&#39;,
   &#39;packed&#39;,
   &#39;with&#39;,
   &#39;non-stop&#39;,
   &#39;action&#39;,
   &#39;,&#39;,
   &#39;stunts&#39;,
   &#39;galore&#39;,
   &#39;,&#39;,
   &#39;an&#39;,
   &#39;interesting&#39;,
   &#39;story&#39;,
   &#39;line&#39;,
   &#39;,&#39;,
   &#39;great&#39;,
   &#39;one-liners&#39;,
   &#39;,&#39;,
   &#39;a&#39;,
   &#39;solid&#39;,
   &#39;cast&#39;,
   &#39;,&#39;,
   &#39;a&#39;,
   &#39;catchy&#39;,
   &#39;musical&#39;,
   &#39;score&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;all&#39;,
   &#39;the&#39;,
   &#39;fun&#39;,
   &#39;and&#39;,
   &#39;adventure&#39;,
   &#39;that&#39;,
   &#39;you&#39;,
   &#39;could&#39;,
   &#39;squeeze&#39;,
   &#39;into&#39;,
   &#39;a&#39;,
   &#39;two-hour&#39;,
   &#39;thrill&#39;,
   &#39;ride&#39;,
   &#39;.&#39;],
  [&#39;if&#39;,
   &#39;you&#39;,
   &quot;don&#39;t&quot;,
   &#39;enjoy&#39;,
   &#39;this&#39;,
   &#39;film&#39;,
   &#39;,&#39;,
   &#39;then&#39;,
   &#39;you&#39;,
   &#39;just&#39;,
   &quot;don&#39;t&quot;,
   &#39;like&#39;,
   &#39;action&#39;,
   &#39;movies&#39;,
   &#39;,&#39;,
   &#39;period&#39;,
   &#39;!&#39;],
  [&#39;if&#39;,
   &quot;you&#39;re&quot;,
   &#39;young&#39;,
   &#39;,&#39;,
   &quot;you&#39;ll&quot;,
   &#39;enjoy&#39;,
   &#39;its&#39;,
   &#39;humor&#39;,
   &#39;,&#39;,
   &#39;its&#39;,
   &#39;cool&#39;,
   &#39;action&#39;,
   &#39;sequences&#39;,
   &#39;and&#39;,
   &#39;its&#39;,
   &#39;gross-out&#39;,
   &#39;factor&#39;,
   &#39;at&#39;,
   &#39;times&#39;,
   &#39;.&#39;],
  [&#39;if&#39;,
   &quot;you&#39;re&quot;,
   &#39;a&#39;,
   &#39;little&#39;,
   &#39;older&#39;,
   &#39;,&#39;,
   &quot;you&#39;ll&quot;,
   &#39;appreciate&#39;,
   &#39;the&#39;,
   &#39;interesting&#39;,
   &#39;plot&#39;,
   &#39;line&#39;,
   &#39;,&#39;,
   &#39;the&#39;,
   &#39;romance&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;yes&#39;,
   &#39;,&#39;,
   &#39;the&#39;,
   &#39;mountains&#39;,
   &#39;of&#39;,
   &#39;adventure&#39;,
   &#39;.&#39;],
  [&#39;watching&#39;,
   &#39;this&#39;,
   &#39;movie&#39;,
   &#39;made&#39;,
   &#39;me&#39;,
   &#39;feel&#39;,
   &#39;like&#39;,
   &#39;a&#39;,
   &#39;kid&#39;,
   &#39;again&#39;,
   &#39;,&#39;,
   &#39;dreaming&#39;,
   &#39;and&#39;,
   &#39;fantasizing&#39;,
   &#39;about&#39;,
   &#39;fighting&#39;,
   &#39;the&#39;,
   &#39;bad&#39;,
   &#39;guys&#39;,
   &#39;,&#39;,
   &#39;travelling&#39;,
   &#39;to&#39;,
   &#39;different&#39;,
   &#39;countries&#39;,
   &#39;,&#39;,
   &#39;making&#39;,
   &#39;the&#39;,
   &#39;impossible&#39;,
   &#39;,&#39;,
   &#39;possible&#39;,
   &#39;!&#39;],
  [&#39;harrison&#39;,
   &#39;ford&#39;,
   &#39;is&#39;,
   &#39;perfect&#39;,
   &#39;as&#39;,
   &#39;the&#39;,
   &#39;every-man&#39;,
   &#39;with&#39;,
   &#39;the&#39;,
   &#39;brains&#39;,
   &#39;of&#39;,
   &#39;a&#39;,
   &#39;scientist&#39;,
   &#39;and&#39;,
   &#39;the&#39;,
   &#39;brawn&#39;,
   &#39;of&#39;,
   &#39;an&#39;,
   &#39;outdoors&#39;,
   &#39;adventurer&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;spielberg&#39;,
   &#39;manages&#39;,
   &#39;to&#39;,
   &#39;achieve&#39;,
   &#39;the&#39;,
   &#39;ideal&#39;,
   &#39;balance&#39;,
   &#39;of&#39;,
   &#39;action&#39;,
   &#39;,&#39;,
   &#39;fun&#39;,
   &#39;,&#39;,
   &#39;adventure&#39;,
   &#39;and&#39;,
   &#39;humor&#39;,
   &#39;.&#39;],
  [&#39;now&#39;,
   &#39;if&#39;,
   &#39;you&#39;,
   &#39;really&#39;,
   &#39;want&#39;,
   &#39;to&#39;,
   &#39;have&#39;,
   &#39;a&#39;,
   &#39;good&#39;,
   &#39;time&#39;,
   &#39;,&#39;,
   &#39;check&#39;,
   &#39;into&#39;,
   &#39;this&#39;,
   &#39;movie&#39;,
   &#39;on&#39;,
   &#39;the&#39;,
   &#39;same&#39;,
   &#39;night&#39;,
   &#39;as&#39;,
   &#39;its&#39;,
   &#39;two&#39;,
   &#39;sequels&#39;,
   &#39;,&#39;,
   &#39;rent&#39;,
   &#39;a&#39;,
   &#39;jug&#39;,
   &#39;of&#39;,
   &#39;iced&#39;,
   &#39;coke&#39;,
   &#39;,&#39;,
   &#39;truckloads&#39;,
   &#39;of&#39;,
   &#39;nachos&#39;,
   &#39;and&#39;,
   &#39;salsa&#39;,
   &#39;,&#39;,
   &#39;an&#39;,
   &#39;adventure&#39;,
   &#39;hat&#39;,
   &#39;and&#39;,
   &#39;whip&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;prepare&#39;,
   &#39;to&#39;,
   &#39;gag&#39;,
   &#39;yourself&#39;,
   &#39;into&#39;,
   &#39;a&#39;,
   &#39;world&#39;,
   &#39;of&#39;,
   &#39;action-movie&#39;,
   &#39;heaven&#39;,
   &#39;!&#39;],
  [&#39;little&#39;,
   &#39;known&#39;,
   &#39;facts&#39;,
   &#39;about&#39;,
   &#39;this&#39;,
   &#39;film&#39;,
   &#39;and&#39;,
   &#39;its&#39;,
   &#39;stars&#39;,
   &#39;:&#39;,
   &#39;this&#39;,
   &#39;picture&#39;,
   &#39;was&#39;,
   &#39;nominated&#39;,
   &#39;for&#39;,
   &#39;eight&#39;,
   &#39;1981&#39;,
   &#39;oscar&#39;,
   &#39;nominations&#39;,
   &#39;,&#39;,
   &#39;including&#39;,
   &#39;best&#39;,
   &#39;picture&#39;,
   &#39;.&#39;],
  [&#39;it&#39;,
   &#39;lost&#39;,
   &#39;that&#39;,
   &#39;award&#39;,
   &#39;to&#39;,
   &#39;chariots&#39;,
   &#39;of&#39;,
   &#39;fire&#39;,
   &#39;,&#39;,
   &#39;but&#39;,
   &#39;did&#39;,
   &#39;manage&#39;,
   &#39;to&#39;,
   &#39;win&#39;,
   &#39;for&#39;,
   &#39;best&#39;,
   &#39;art&#39;,
   &#39;direction&#39;,
   &#39;,&#39;,
   &#39;best&#39;,
   &#39;special&#39;,
   &#39;effects&#39;,
   &#39;,&#39;,
   &#39;best&#39;,
   &#39;film&#39;,
   &#39;editing&#39;,
   &#39;and&#39;,
   &#39;best&#39;,
   &#39;sound&#39;,
   &#39;.&#39;],
  [&#39;actor&#39;,
   &#39;tom&#39;,
   &#39;selleck&#39;,
   &#39;was&#39;,
   &#39;originally&#39;,
   &#39;cast&#39;,
   &#39;as&#39;,
   &#39;indiana&#39;,
   &#39;jones&#39;,
   &#39;,&#39;,
   &#39;but&#39;,
   &#39;was&#39;,
   &#39;committed&#39;,
   &#39;to&#39;,
   &#39;his&#39;,
   &#39;hit&#39;,
   &#39;tv&#39;,
   &#39;show&#39;,
   &#39;,&#39;,
   &#39;&quot;&#39;,
   &#39;magnum&#39;,
   &#39;p&#39;,
   &#39;.&#39;,
   &#39;i&#39;,
   &#39;.&#39;,
   &#39;&quot;&#39;,
   &#39;.&#39;],
  [&#39;in&#39;,
   &#39;filming&#39;,
   &#39;the&#39;,
   &#39;well&#39;,
   &#39;of&#39;,
   &#39;souls&#39;,
   &#39;sequence&#39;,
   &#39;,&#39;,
   &#39;the&#39;,
   &#39;producers&#39;,
   &#39;scoured&#39;,
   &#39;every&#39;,
   &#39;pet&#39;,
   &#39;shop&#39;,
   &#39;in&#39;,
   &#39;london&#39;,
   &#39;and&#39;,
   &#39;the&#39;,
   &#39;south&#39;,
   &#39;of&#39;,
   &#39;england&#39;,
   &#39;for&#39;,
   &#39;every&#39;,
   &#39;snake&#39;,
   &#39;they&#39;,
   &#39;could&#39;,
   &#39;lay&#39;,
   &#39;their&#39;,
   &#39;hands&#39;,
   &#39;on&#39;,
   &#39;.&#39;],
  [&#39;hence&#39;,
   &#39;there&#39;,
   &#39;are&#39;,
   &#39;snakes&#39;,
   &#39;that&#39;,
   &#39;are&#39;,
   &#39;identifiable&#39;,
   &#39;from&#39;,
   &#39;many&#39;,
   &#39;different&#39;,
   &#39;geographical&#39;,
   &#39;areas&#39;,
   &#39;.&#39;],
  [&#39;however&#39;,
   &#39;,&#39;,
   &#39;once&#39;,
   &#39;all&#39;,
   &#39;the&#39;,
   &#39;snakes&#39;,
   &#39;were&#39;,
   &#39;on&#39;,
   &#39;set&#39;,
   &#39;,&#39;,
   &#39;it&#39;,
   &#39;became&#39;,
   &#39;clear&#39;,
   &#39;that&#39;,
   &#39;there&#39;,
   &#39;were&#39;,
   &#39;not&#39;,
   &#39;nearly&#39;,
   &#39;enough&#39;,
   &#39;of&#39;,
   &#39;them&#39;,
   &#39;,&#39;,
   &#39;so&#39;,
   &#39;spielberg&#39;,
   &#39;had&#39;,
   &#39;several&#39;,
   &#39;hoses&#39;,
   &#39;cut&#39;,
   &#39;into&#39;,
   &#39;lengths&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;these&#39;,
   &#39;were&#39;,
   &#39;used&#39;,
   &#39;as&#39;,
   &#39;well&#39;,
   &#39;.&#39;],
  [&#39;looking&#39;,
   &#39;closely&#39;,
   &#39;,&#39;,
   &#39;you&#39;,
   &#39;can&#39;,
   &#39;tell&#39;,
   &#39;which&#39;,
   &#39;are&#39;,
   &#39;the&#39;,
   &#39;real&#39;,
   &#39;snakes&#39;,
   &#39;and&#39;,
   &#39;which&#39;,
   &#39;are&#39;,
   &#39;not&#39;,
   &#39;.&#39;],
  [&#39;an&#39;,
   &#39;early&#39;,
   &#39;draft&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;script&#39;,
   &#39;had&#39;,
   &#39;indy&#39;,
   &#39;travelling&#39;,
   &#39;to&#39;,
   &#39;shanghai&#39;,
   &#39;to&#39;,
   &#39;recover&#39;,
   &#39;a&#39;,
   &#39;piece&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;staff&#39;,
   &#39;of&#39;,
   &#39;ra&#39;,
   &#39;.&#39;],
  [&#39;during&#39;,
   &#39;his&#39;,
   &#39;escape&#39;,
   &#39;from&#39;,
   &#39;the&#39;,
   &#39;museum&#39;,
   &#39;where&#39;,
   &#39;it&#39;,
   &#39;was&#39;,
   &#39;housed&#39;,
   &#39;,&#39;,
   &#39;he&#39;,
   &#39;sheltered&#39;,
   &#39;from&#39;,
   &#39;machine&#39;,
   &#39;gun&#39;,
   &#39;fire&#39;,
   &#39;behind&#39;,
   &#39;a&#39;,
   &#39;giant&#39;,
   &#39;rolling&#39;,
   &#39;gong&#39;,
   &#39;.&#39;],
  [&#39;also&#39;,
   &#39;in&#39;,
   &#39;the&#39;,
   &#39;same&#39;,
   &#39;script&#39;,
   &#39;,&#39;,
   &#39;indy&#39;,
   &#39;and&#39;,
   &#39;marion&#39;,
   &#39;flee&#39;,
   &#39;the&#39;,
   &#39;chaos&#39;,
   &#39;caused&#39;,
   &#39;by&#39;,
   &#39;the&#39;,
   &#39;opening&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;ark&#39;,
   &#39;in&#39;,
   &#39;a&#39;,
   &#39;wild&#39;,
   &#39;mine-cart&#39;,
   &#39;chase&#39;,
   &#39;sequence&#39;,
   &#39;.&#39;],
  [&#39;both&#39;,
   &#39;of&#39;,
   &#39;these&#39;,
   &#39;scenes&#39;,
   &#39;were&#39;,
   &#39;cut&#39;,
   &#39;from&#39;,
   &#39;the&#39;,
   &#39;script&#39;,
   &#39;,&#39;,
   &#39;but&#39;,
   &#39;ended&#39;,
   &#39;up&#39;,
   &#39;in&#39;,
   &quot;1984&#39;s&quot;,
   &#39;indiana&#39;,
   &#39;jones&#39;,
   &#39;and&#39;,
   &#39;the&#39;,
   &#39;temple&#39;,
   &#39;of&#39;,
   &#39;doom&#39;,
   &#39;.&#39;],
  [&#39;this&#39;,
   &#39;film&#39;,
   &#39;begins&#39;,
   &#39;with&#39;,
   &#39;a&#39;,
   &#39;shot&#39;,
   &#39;of&#39;,
   &#39;a&#39;,
   &#39;peak&#39;,
   &#39;in&#39;,
   &#39;the&#39;,
   &#39;jungle&#39;,
   &#39;which&#39;,
   &#39;is&#39;,
   &#39;reminiscent&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;paramount&#39;,
   &#39;pictures&#39;,
   &#39;logo&#39;,
   &#39;.&#39;],
  [&#39;the&#39;,
   &#39;same&#39;,
   &#39;type&#39;,
   &#39;of&#39;,
   &#39;opening&#39;,
   &#39;is&#39;,
   &#39;present&#39;,
   &#39;in&#39;,
   &#39;its&#39;,
   &#39;sequels&#39;,
   &#39;.&#39;],
  [&quot;jock&#39;s&quot;,
   &#39;airplane&#39;,
   &#39;at&#39;,
   &#39;the&#39;,
   &#39;beginning&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;film&#39;,
   &#39;has&#39;,
   &#39;the&#39;,
   &#39;registration&#39;,
   &#39;number&#39;,
   &#39;&quot;&#39;,
   &#39;ob-cpo&#39;,
   &#39;&quot;&#39;,
   &#39;.&#39;],
  [&#39;this&#39;,
   &#39;is&#39;,
   &#39;a&#39;,
   &#39;reference&#39;,
   &#39;to&#39;,
   &#39;obi-wan&#39;,
   &#39;and&#39;,
   &#39;c-3po&#39;,
   &#39;from&#39;,
   &#39;george&#39;,
   &quot;lucas&#39;&quot;,
   &#39;star&#39;,
   &#39;wars&#39;,
   &#39;(&#39;,
   &#39;9&#39;,
   &#39;.&#39;,
   &#39;5/10&#39;,
   &#39;)&#39;,
   &#39;.&#39;],
  [&#39;also&#39;,
   &#39;,&#39;,
   &#39;the&#39;,
   &#39;hieroglyphics&#39;,
   &#39;in&#39;,
   &#39;the&#39;,
   &#39;well&#39;,
   &#39;of&#39;,
   &#39;souls&#39;,
   &#39;include&#39;,
   &#39;engravings&#39;,
   &#39;of&#39;,
   &#39;r2-d2&#39;,
   &#39;and&#39;,
   &#39;c-3po&#39;,
   &#39;.&#39;],
  [&#39;they&#39;,
   &#39;can&#39;,
   &#39;be&#39;,
   &#39;seen&#39;,
   &#39;on&#39;,
   &#39;a&#39;,
   &#39;post&#39;,
   &#39;to&#39;,
   &#39;the&#39;,
   &#39;right&#39;,
   &#39;of&#39;,
   &#39;indy&#39;,
   &#39;and&#39;,
   &#39;sallah&#39;,
   &#39;as&#39;,
   &#39;they&#39;,
   &#39;remove&#39;,
   &#39;the&#39;,
   &#39;ark&#39;,
   &#39;.&#39;],
  [&#39;the&#39;,
   &#39;script&#39;,
   &#39;originally&#39;,
   &#39;included&#39;,
   &#39;a&#39;,
   &#39;long&#39;,
   &#39;fight&#39;,
   &#39;between&#39;,
   &#39;a&#39;,
   &#39;swordsman&#39;,
   &#39;and&#39;,
   &#39;indiana&#39;,
   &#39;with&#39;,
   &#39;his&#39;,
   &#39;whip&#39;,
   &#39;.&#39;],
  [&#39;as&#39;,
   &#39;legend&#39;,
   &#39;has&#39;,
   &#39;it&#39;,
   &#39;,&#39;,
   &#39;actor&#39;,
   &#39;harrison&#39;,
   &#39;ford&#39;,
   &#39;was&#39;,
   &#39;suffering&#39;,
   &#39;diarrhea&#39;,
   &#39;at&#39;,
   &#39;the&#39;,
   &#39;time&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;asked&#39;,
   &#39;if&#39;,
   &#39;the&#39;,
   &#39;scene&#39;,
   &#39;could&#39;,
   &#39;be&#39;,
   &#39;shortened&#39;,
   &#39;.&#39;],
  [&#39;spielberg&#39;,
   &#39;said&#39;,
   &#39;the&#39;,
   &#39;only&#39;,
   &#39;way&#39;,
   &#39;he&#39;,
   &#39;could&#39;,
   &#39;shorten&#39;,
   &#39;it&#39;,
   &#39;was&#39;,
   &#39;if&#39;,
   &#39;indy&#39;,
   &#39;pulled&#39;,
   &#39;out&#39;,
   &#39;his&#39;,
   &#39;gun&#39;,
   &#39;and&#39;,
   &#39;just&#39;,
   &#39;shot&#39;,
   &#39;the&#39;,
   &#39;guy&#39;,
   &#39;.&#39;],
  [&#39;the&#39;,
   &#39;entire&#39;,
   &#39;crew&#39;,
   &#39;laughed&#39;,
   &#39;and&#39;,
   &quot;that&#39;s&quot;,
   &#39;how&#39;,
   &#39;it&#39;,
   &#39;was&#39;,
   &#39;filmed&#39;,
   &#39;.&#39;],
  [&#39;when&#39;,
   &#39;indy&#39;,
   &#39;first&#39;,
   &#39;falls&#39;,
   &#39;in&#39;,
   &#39;the&#39;,
   &#39;well&#39;,
   &#39;of&#39;,
   &#39;souls&#39;,
   &#39;and&#39;,
   &#39;is&#39;,
   &#39;face&#39;,
   &#39;to&#39;,
   &#39;face&#39;,
   &#39;with&#39;,
   &#39;the&#39;,
   &#39;cobra&#39;,
   &#39;,&#39;,
   &#39;you&#39;,
   &#39;can&#39;,
   &#39;see&#39;,
   &#39;the&#39;,
   &quot;snake&#39;s&quot;,
   &#39;reflection&#39;,
   &#39;on&#39;,
   &#39;the&#39;,
   &#39;glass&#39;,
   &#39;dividing&#39;,
   &#39;it&#39;,
   &#39;and&#39;,
   &#39;harrison&#39;,
   &#39;ford&#39;,
   &#39;,&#39;,
   &#39;also&#39;,
   &#39;some&#39;,
   &#39;fingerprints&#39;,
   &#39;and&#39;,
   &#39;stuff&#39;,
   &#39;like&#39;,
   &#39;that&#39;,
   &#39;.&#39;],
  [&#39;when&#39;,
   &#39;indy&#39;,
   &#39;is&#39;,
   &#39;dragging&#39;,
   &#39;along&#39;,
   &#39;the&#39;,
   &#39;ground&#39;,
   &#39;,&#39;,
   &#39;hanging&#39;,
   &#39;onto&#39;,
   &#39;the&#39;,
   &#39;nazi&#39;,
   &quot;soldier&#39;s&quot;,
   &#39;truck&#39;,
   &#39;with&#39;,
   &#39;the&#39;,
   &#39;ark&#39;,
   &#39;inside&#39;,
   &#39;,&#39;,
   &#39;you&#39;,
   &#39;can&#39;,
   &#39;see&#39;,
   &#39;the&#39;,
   &#39;pad&#39;,
   &#39;that&#39;,
   &quot;he&#39;s&quot;,
   &#39;being&#39;,
   &#39;dragged&#39;,
   &#39;on&#39;,
   &#39;.&#39;]],
 &#39;pos&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       , and boon is the comedian . he&#39;s got a steady...
Name: 50, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">50</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;, and boon is the comedian . he\&#39;s got a steady-date , katy ( karen allen ) , but she\&#39;s sick of playing second-fiddle to a bottle of j . d . then there are the others : pinto , a wimp ; flounder , a blimp ; d . day , a biker ; stork , who may or may not have brain-damage ; and last but not least . . . bluto ! bluto , played by the late , great john belushi , is the man . he\&#39;s the kind of guy who slugs back entire fifths of whiskey then proclaim , &quot; i needed that . &quot; the kind of guy who puts a cream-filled snowball into his mouth , puffs up his cheeks and spits it out , and then says &quot; i\&#39;m a zit -- get it ? &quot; the story is as follows : the omegas are getting the deltas kicked off campus . the deltas , knowing that fighting the omegas is stupid , decide to go out with style , throwing a wild toga party and ruining the homecoming parade . this is the fucnniest movie int he history of the world . do yourself a favor and go see it . &#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">splits</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>([[&#39;national&#39;,
   &quot;lampoon&#39;s&quot;,
   &#39;animal&#39;,
   &#39;house&#39;,
   &#39;,&#39;,
   &#39;made&#39;,
   &#39;in&#39;,
   &#39;1978&#39;,
   &#39;and&#39;,
   &#39;set&#39;,
   &#39;in&#39;,
   &#39;1962&#39;,
   &#39;,&#39;,
   &#39;remains&#39;,
   &#39;one&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;--&#39;,
   &#39;no&#39;,
   &#39;,&#39;,
   &#39;fuck&#39;,
   &#39;that&#39;,
   &#39;noise&#39;,
   &#39;--&#39;,
   &#39;*&#39;,
   &#39;the&#39;,
   &#39;*&#39;,
   &#39;funniest&#39;,
   &#39;movie&#39;,
   &#39;ever&#39;,
   &#39;made&#39;,
   &#39;.&#39;],
  [&#39;and&#39;,
   &#39;this&#39;,
   &quot;isn&#39;t&quot;,
   &#39;just&#39;,
   &#39;my&#39;,
   &#39;opinion&#39;,
   &#39;,&#39;,
   &#39;either&#39;,
   &#39;;&#39;,
   &#39;everybody&#39;,
   &#39;knows&#39;,
   &#39;this&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &quot;that&#39;s&quot;,
   &#39;why&#39;,
   &#39;about&#39;,
   &#39;a&#39;,
   &#39;gazillion&#39;,
   &#39;inferior&#39;,
   &#39;rip-offs&#39;,
   &#39;have&#39;,
   &#39;been&#39;,
   &#39;made&#39;,
   &#39;,&#39;,
   &#39;trying&#39;,
   &#39;to&#39;,
   &#39;duplicate&#39;,
   &#39;its&#39;,
   &#39;success&#39;,
   &#39;.&#39;],
  [&#39;(&#39;, &#39;pcu&#39;, &#39;anyone&#39;, &#39;?&#39;],
  [&#39;and&#39;,
   &#39;the&#39;,
   &#39;first&#39;,
   &#39;person&#39;,
   &#39;to&#39;,
   &#39;bring&#39;,
   &#39;up&#39;,
   &#39;glory&#39;,
   &#39;daze&#39;,
   &#39;gets&#39;,
   &#39;decked&#39;,
   &#39;.&#39;,
   &#39;)&#39;],
  [&#39;animal&#39;,
   &#39;house&#39;,
   &#39;takes&#39;,
   &#39;place&#39;,
   &#39;at&#39;,
   &#39;the&#39;,
   &#39;fictional&#39;,
   &#39;faber&#39;,
   &#39;college&#39;,
   &#39;,&#39;,
   &#39;circa&#39;,
   &#39;1962&#39;,
   &#39;,&#39;,
   &#39;where&#39;,
   &#39;the&#39;,
   &#39;omega&#39;,
   &#39;frat&#39;,
   &#39;calls&#39;,
   &#39;the&#39;,
   &#39;shots&#39;,
   &#39;.&#39;],
  [&#39;these&#39;,
   &#39;guys&#39;,
   &#39;are&#39;,
   &#39;wholesome&#39;,
   &#39;,&#39;,
   &#39;clean-cut&#39;,
   &#39;,&#39;,
   &#39;model-citizens&#39;,
   &#39;.&#39;,
   &#39;.&#39;,
   &#39;.&#39;],
  [&#39;i&#39;, &#39;.&#39;, &#39;e&#39;, &#39;.&#39;],
  [&#39;a&#39;, &#39;bunch&#39;, &#39;of&#39;, &#39;assholes&#39;, &#39;.&#39;],
  [&#39;greg&#39;,
   &#39;,&#39;,
   &#39;their&#39;,
   &#39;leader&#39;,
   &#39;,&#39;,
   &#39;is&#39;,
   &#39;going&#39;,
   &#39;out&#39;,
   &#39;with&#39;,
   &#39;mandy&#39;,
   &#39;pepperidge&#39;,
   &#39;,&#39;,
   &#39;but&#39;,
   &#39;since&#39;,
   &#39;the&#39;,
   &#39;silly&#39;,
   &#39;bastard&#39;,
   &quot;doesn&#39;t&quot;,
   &#39;believe&#39;,
   &#39;in&#39;,
   &#39;pre-marital&#39;,
   &#39;sex&#39;,
   &#39;,&#39;,
   &#39;their&#39;,
   &#39;relationship&#39;,
   &#39;never&#39;,
   &#39;goes&#39;,
   &#39;further&#39;,
   &#39;than&#39;,
   &#39;a&#39;,
   &#39;quick&#39;,
   &#39;jack-off&#39;,
   &#39;under&#39;,
   &#39;the&#39;,
   &#39;stars&#39;,
   &#39;.&#39;],
  [&#39;neidermeyer&#39;,
   &#39;is&#39;,
   &#39;the&#39;,
   &#39;supreme-bozo&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;bunch&#39;,
   &#39;,&#39;,
   &#39;walking&#39;,
   &#39;around&#39;,
   &#39;with&#39;,
   &#39;his&#39;,
   &#39;dick&#39;,
   &#39;out&#39;,
   &#39;kicking&#39;,
   &#39;freshman&#39;,
   &#39;ass&#39;,
   &#39;and&#39;,
   &#39;trying&#39;,
   &#39;to&#39;,
   &#39;impress&#39;,
   &#39;the&#39;,
   &#39;muff&#39;,
   &#39;.&#39;],
  [&#39;also&#39;,
   &#39;hanging&#39;,
   &#39;around&#39;,
   &#39;these&#39;,
   &#39;losers&#39;,
   &#39;is&#39;,
   &#39;babs&#39;,
   &#39;,&#39;,
   &#39;future&#39;,
   &#39;universal&#39;,
   &#39;studios&#39;,
   &#39;employee&#39;,
   &#39;and&#39;,
   &#39;serious&#39;,
   &#39;bitch&#39;,
   &#39;.&#39;],
  [&#39;now&#39;,
   &quot;let&#39;s&quot;,
   &#39;just&#39;,
   &#39;take&#39;,
   &#39;a&#39;,
   &#39;peak&#39;,
   &#39;next&#39;,
   &#39;door&#39;,
   &#39;,&#39;,
   &#39;at&#39;,
   &#39;the&#39;,
   &#39;delta&#39;,
   &#39;house&#39;,
   &#39;.&#39;],
  [&#39;over&#39;,
   &#39;here&#39;,
   &#39;,&#39;,
   &#39;anything&#39;,
   &#39;goes&#39;,
   &#39;:&#39;,
   &#39;you&#39;,
   &#39;wanna&#39;,
   &#39;throw&#39;,
   &#39;shit&#39;,
   &#39;out&#39;,
   &#39;the&#39;,
   &#39;window&#39;,
   &#39;?&#39;],
  [&#39;okay&#39;, &#39;.&#39;],
  [&#39;you&#39;,
   &#39;wanna&#39;,
   &#39;crush&#39;,
   &#39;a&#39;,
   &#39;bunch&#39;,
   &#39;of&#39;,
   &#39;beer&#39;,
   &#39;cans&#39;,
   &#39;on&#39;,
   &#39;your&#39;,
   &#39;forehead&#39;,
   &#39;and&#39;,
   &#39;pour&#39;,
   &#39;honey-mustard&#39;,
   &#39;all&#39;,
   &#39;over&#39;,
   &#39;your&#39;,
   &#39;chest&#39;,
   &#39;?&#39;],
  [&#39;go&#39;, &#39;right&#39;, &#39;ahead&#39;, &#39;.&#39;],
  [&#39;the&#39;,
   &quot;frat&#39;s&quot;,
   &#39;leaders&#39;,
   &#39;are&#39;,
   &#39;otter&#39;,
   &#39;and&#39;,
   &#39;boon&#39;,
   &#39;(&#39;,
   &#39;tim&#39;,
   &#39;matheson&#39;,
   &#39;and&#39;,
   &#39;peter&#39;,
   &#39;riegert&#39;,
   &#39;)&#39;,
   &#39;.&#39;],
  [&#39;otter&#39;,
   &#39;is&#39;,
   &#39;the&#39;,
   &quot;ladies&#39;&quot;,
   &#39;man&#39;,
   &#39;,&#39;,
   &#39;going&#39;,
   &#39;out&#39;,
   &#39;with&#39;,
   &#39;another&#39;,
   &#39;girl&#39;,
   &#39;every&#39;,
   &#39;night&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;boon&#39;,
   &#39;is&#39;,
   &#39;the&#39;,
   &#39;comedian&#39;,
   &#39;.&#39;],
  [&quot;he&#39;s&quot;,
   &#39;got&#39;,
   &#39;a&#39;,
   &#39;steady-date&#39;,
   &#39;,&#39;,
   &#39;katy&#39;,
   &#39;(&#39;,
   &#39;karen&#39;,
   &#39;allen&#39;,
   &#39;)&#39;,
   &#39;,&#39;,
   &#39;but&#39;,
   &quot;she&#39;s&quot;,
   &#39;sick&#39;,
   &#39;of&#39;,
   &#39;playing&#39;,
   &#39;second-fiddle&#39;,
   &#39;to&#39;,
   &#39;a&#39;,
   &#39;bottle&#39;,
   &#39;of&#39;,
   &#39;j&#39;,
   &#39;.&#39;,
   &#39;d&#39;,
   &#39;.&#39;],
  [&#39;then&#39;,
   &#39;there&#39;,
   &#39;are&#39;,
   &#39;the&#39;,
   &#39;others&#39;,
   &#39;:&#39;,
   &#39;pinto&#39;,
   &#39;,&#39;,
   &#39;a&#39;,
   &#39;wimp&#39;,
   &#39;;&#39;,
   &#39;flounder&#39;,
   &#39;,&#39;,
   &#39;a&#39;,
   &#39;blimp&#39;,
   &#39;;&#39;,
   &#39;d&#39;,
   &#39;.&#39;,
   &#39;day&#39;,
   &#39;,&#39;,
   &#39;a&#39;,
   &#39;biker&#39;,
   &#39;;&#39;,
   &#39;stork&#39;,
   &#39;,&#39;,
   &#39;who&#39;,
   &#39;may&#39;,
   &#39;or&#39;,
   &#39;may&#39;,
   &#39;not&#39;,
   &#39;have&#39;,
   &#39;brain-damage&#39;,
   &#39;;&#39;,
   &#39;and&#39;,
   &#39;last&#39;,
   &#39;but&#39;,
   &#39;not&#39;,
   &#39;least&#39;,
   &#39;.&#39;,
   &#39;.&#39;,
   &#39;.&#39;],
  [&#39;bluto&#39;, &#39;!&#39;],
  [&#39;bluto&#39;,
   &#39;,&#39;,
   &#39;played&#39;,
   &#39;by&#39;,
   &#39;the&#39;,
   &#39;late&#39;,
   &#39;,&#39;,
   &#39;great&#39;,
   &#39;john&#39;,
   &#39;belushi&#39;,
   &#39;,&#39;,
   &#39;is&#39;,
   &#39;the&#39;,
   &#39;man&#39;,
   &#39;.&#39;],
  [&quot;he&#39;s&quot;,
   &#39;the&#39;,
   &#39;kind&#39;,
   &#39;of&#39;,
   &#39;guy&#39;,
   &#39;who&#39;,
   &#39;slugs&#39;,
   &#39;back&#39;,
   &#39;entire&#39;,
   &#39;fifths&#39;,
   &#39;of&#39;,
   &#39;whiskey&#39;,
   &#39;then&#39;,
   &#39;proclaim&#39;,
   &#39;,&#39;,
   &#39;&quot;&#39;,
   &#39;i&#39;,
   &#39;needed&#39;,
   &#39;that&#39;,
   &#39;.&#39;,
   &#39;&quot;&#39;],
  [&#39;the&#39;,
   &#39;kind&#39;,
   &#39;of&#39;,
   &#39;guy&#39;,
   &#39;who&#39;,
   &#39;puts&#39;,
   &#39;a&#39;,
   &#39;cream-filled&#39;,
   &#39;snowball&#39;,
   &#39;into&#39;,
   &#39;his&#39;,
   &#39;mouth&#39;,
   &#39;,&#39;,
   &#39;puffs&#39;,
   &#39;up&#39;,
   &#39;his&#39;,
   &#39;cheeks&#39;,
   &#39;and&#39;,
   &#39;spits&#39;,
   &#39;it&#39;,
   &#39;out&#39;,
   &#39;,&#39;,
   &#39;and&#39;,
   &#39;then&#39;,
   &#39;says&#39;,
   &#39;&quot;&#39;,
   &quot;i&#39;m&quot;,
   &#39;a&#39;,
   &#39;zit&#39;,
   &#39;--&#39;,
   &#39;get&#39;,
   &#39;it&#39;,
   &#39;?&#39;,
   &#39;&quot;&#39;],
  [&#39;the&#39;,
   &#39;story&#39;,
   &#39;is&#39;,
   &#39;as&#39;,
   &#39;follows&#39;,
   &#39;:&#39;,
   &#39;the&#39;,
   &#39;omegas&#39;,
   &#39;are&#39;,
   &#39;getting&#39;,
   &#39;the&#39;,
   &#39;deltas&#39;,
   &#39;kicked&#39;,
   &#39;off&#39;,
   &#39;campus&#39;,
   &#39;.&#39;],
  [&#39;the&#39;,
   &#39;deltas&#39;,
   &#39;,&#39;,
   &#39;knowing&#39;,
   &#39;that&#39;,
   &#39;fighting&#39;,
   &#39;the&#39;,
   &#39;omegas&#39;,
   &#39;is&#39;,
   &#39;stupid&#39;,
   &#39;,&#39;,
   &#39;decide&#39;,
   &#39;to&#39;,
   &#39;go&#39;,
   &#39;out&#39;,
   &#39;with&#39;,
   &#39;style&#39;,
   &#39;,&#39;,
   &#39;throwing&#39;,
   &#39;a&#39;,
   &#39;wild&#39;,
   &#39;toga&#39;,
   &#39;party&#39;,
   &#39;and&#39;,
   &#39;ruining&#39;,
   &#39;the&#39;,
   &#39;homecoming&#39;,
   &#39;parade&#39;,
   &#39;.&#39;],
  [&#39;this&#39;,
   &#39;is&#39;,
   &#39;the&#39;,
   &#39;fucnniest&#39;,
   &#39;movie&#39;,
   &#39;int&#39;,
   &#39;he&#39;,
   &#39;history&#39;,
   &#39;of&#39;,
   &#39;the&#39;,
   &#39;world&#39;,
   &#39;.&#39;],
  [&#39;do&#39;, &#39;yourself&#39;, &#39;a&#39;, &#39;favor&#39;, &#39;and&#39;, &#39;go&#39;, &#39;see&#39;, &#39;it&#39;, &#39;.&#39;]],
 &#39;pos&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">82</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>gold                                                     pos
pred                                                     neg
correct                                                   no
text       less music , and john landis seems to have los...
Name: 82, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">82</span><span class="p">][</span><span class="s1">&#39;text&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;less music , and john landis seems to have lost interest in the whole thing . there\&#39;s a few early crashes , and then one huge pile-up , but after that it all stops . it\&#39;s just the music . one of my problems with the first is that cab calloway\&#39;s song is so good the actually blues brothers look dull after him , but there\&#39;s no problems with this . the music is all as good as ever , tons of great musicians showing up -- with the exception of johnny lang , who can\&#39;t sing , all the musicians do a great job . the only real problems i had was the special effects . these were superfluous and a waste of money . since the film isn\&#39;t doing very well , they could mean we have no possibility of another sequel , which i want to see . the bluegrass version of riders in the sky is even better than rawhide . -- http : //www . geocities . com/hollywood/academy/8034/ remove no spam to reply . &quot; drive carefully but recklessly &quot; , mama , child\&#39;s toy &quot; the only excercise i take is walking behind the coffins of friends who took exercise . &quot; peter o\&#39;toole &#39;
</pre></div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>